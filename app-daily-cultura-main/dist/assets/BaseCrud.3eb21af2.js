import{d as se,a as ae,u as ie,q as le,b as oe,v as g,E as u,H as Y,N as ne,O as x,r as N,e as C,f as n,g as d,h as t,i as c,l as s,k as v,w as l,t as o,n as y,j as L,F as z,x as P,y as B}from"./index.c93647e1.js";import{u as re,_ as q,a as ce,b as de,B as ue,c as T,d as _e}from"./DatasheetFormat.bb093e19.js";import{_ as I}from"./Input.d2784565.js";import{_ as E}from"./Select.7b4ad9bd.js";import{g as me}from"./get_status.6c591513.js";const pe={class:"intro-y flex flex-col gap-2"},fe={class:"flex flex-col gap-3 lg:grid lg:grid-cols-4 lg:items-end"},he={class:"grid grid-cols-2 gap-3"},ve={class:"w-full"},ge={key:0,class:"w-full"},ye={key:1,class:"w-full"},be={key:0,class:"flex flex-col justify-start h-full"},xe=t("label",{for:"regular-form-2",class:"form-label font-bold min-w-max mr-2"},"FECHA RANGO",-1),we={class:"grid grid-cols-2 gap-1.5 w-full intro-x"},ke={key:1,class:"flex items-start gap-6 h-full"},Ve={class:"w-full intro-x"},Ce={key:2,class:"flex items-start gap-6 h-full"},ze={class:"w-full intro-x"},Be={class:"flex gap-1 relative"},Ee={class:"flex gap-1 relative"},De={class:"flex gap-1 relative"},$e={class:"flex justify-end"},Oe={class:"customize-item"},Se={key:0,class:"w-10 h-10 rounded-lg bg-gray-800 text-white flex items-center justify-center"},Fe=["src"],Ne={class:"customize-item"},Te=["src"],Ie={class:"px-4 py-1 rounded-full text-white bg-blue-400 font-semibold text-sm flex align-center w-max cursor-pointer active:bg-gray-300 transition duration-300 ease"},Re={class:"customize-item"},Ae={class:"customize-item"},je={class:"customize-item"},Me={class:"customize-item"},Ue={class:"customize-item"},Ye={class:"customize-item"},Le={class:"customize-item"},Pe={class:"customize-item"},qe={class:"customize-item"},He={class:"customize-item"},Ge={class:"customize-item"},Je={class:"customize-item"},Ke={class:"customize-item"},Qe={class:"customize-item"},We={class:"block"},Xe={class:"list-decimal list-outside flex flex-col gap-y-1 justify-end text-sm font-medium"},Ze={class:"inline-flex items-center py-0.5 text-gray-800 whitespace-nowrap"},et={class:"customize-item"},tt={class:"flex items-center"},st={class:"flex items-center"},at={class:"flex gap-2 justify-end"},it=["onClick"],lt=t("span",{class:"text-sm whitespace-nowrap"}," Cambiar contrase\xF1a ",-1),ot={class:"flex gap-2 justify-end"},nt=["id"],rt=["onClick"],ct=t("span",{class:"text-sm"}," Editar ",-1),ft=se({__name:"BaseCrud",props:{edit_gestor:{type:Boolean,default:!1},headers:null,items:null,item_see_fnc:{type:[Function,Boolean],default:()=>!1},item_see_fullview:{type:Boolean,default:!1},label:{default:""},management_permissions:{type:Boolean,default:!1},onDeleteFnc:{type:Function,default:()=>!1},show_exports:{type:Boolean,default:!1},hiddenButton:{type:Boolean,default:!1}},emits:["change_status","change_filter"],setup(_,{emit:D}){const R=_,A="https://cultura.ssiset.com",H=ae(),$=ie(),G=le(),{options:O}=oe(),S=g(()=>String(G.name).split(".")[0]),J=g(()=>R.headers.filter(a=>a.value!="actions"&&a.value!="created_at"&&a.value!="status"&&a.value!="status").map(a=>({value:a.value,label:a.text})).sort((a,f)=>{const p=a.label.toLowerCase(),h=f.label.toLowerCase();return p<h?-1:p>h?1:0})),K=g(()=>{let r=O.status;return r.push({label:"TODOS",value:"all"}),r}),F=g(()=>!!(u.computed.is_role("super.root")||u.computed.is_role("root"))),j=Y({by:"",type:""}),i=Y({search_field:"",search_value:"",status_criteria:"all",user_status_criteria:"",date_criteria_start:"",date_criteria_end:""});ne(()=>i.search_field,()=>{i.search_value=""});const M=g(()=>{const r={binnacle_name:"binnacles",lineament_id:"lineaments"};let a=[];return r[i.search_field]?a=O[r[i.search_field]]:a=O[i.search_field],a||[]}),Q=()=>{D("change_filter",i)},W=()=>{i.search_field="",i.search_value="",i.status_criteria="all",i.user_status_criteria="",i.date_criteria_start="",i.date_criteria_end="",D("change_filter",i)};g(()=>{const r=[];return i.status_criteria!="all"&&r.push({field:"status",comparison:"=",criteria:i.status_criteria}),i.user_status_criteria!==""&&r.push({field:"status",comparison:"=",criteria:i.user_status_criteria}),i.date_criteria_start!==""&&r.push({field:"created_at",criteria:i.date_criteria_start,comparison:(a,f)=>{const p=x(a).format("YYYY-MM-DD"),h=new Date(p).getTime(),b=new Date(f).getTime(),e=g(()=>i.date_criteria_end!==""?new Date(i.date_criteria_end).getTime():new Date().getTime());return h>=b&&h<=e.value}}),r});const w=N(!1),k=N(!1),V=N(!1),X=r=>{R.edit_gestor?$.push({name:`${S.value}.edit`,params:{id:r}}):$.push({name:`${S.value}.edit`,params:{id:r}})},Z=r=>{$.push({name:`${S.value}.changePassword`,params:{id:r}})},ee=r=>{const a=H.get_user.id,{user_id:f,created_by:p,status:h}=r,b=p==a||f==a||p&&p.id===a;return!!(h=="REC"&&b)},{hasDoubleManagement:te,reviewersFromDouble:U}=re();return(r,a)=>{const f=C("FilterIcon"),p=C("ExternalLinkIcon"),h=C("EditIcon"),b=C("DataTable");return n(),d("div",pe,[t("section",fe,[t("div",he,[t("div",ve,[c(E,{label:"BUSCAR EN",tooltip:"Seleccione en que campo quiere buscar",placeholder:"Seleccione",name:"search_field",modelValue:s(i).search_field,"onUpdate:modelValue":a[0]||(a[0]=e=>s(i).search_field=e),options:s(J)},null,8,["modelValue","options"])]),s(M).length?(n(),d("div",ge,[c(E,{label:"NOMBRE",tooltip:"Seleccione el valor a buscar",placeholder:"Seleccione",name:"search_value",modelValue:s(i).search_value,"onUpdate:modelValue":a[1]||(a[1]=e=>s(i).search_value=e),options:s(M)},null,8,["modelValue","options"])])):(n(),d("div",ye,[c(I,{type:"text",label:"VALOR",tooltip:"Ingrese el valor a buscar",placeholder:"Valor",name:"search_value",modelValue:s(i).search_value,"onUpdate:modelValue":a[2]||(a[2]=e=>s(i).search_value=e)},null,8,["modelValue"])]))]),s(V)?(n(),d("div",be,[xe,t("div",we,[c(I,{class:"",type:"date",tooltip:"Desde",name:"date_criteria_start",modelValue:s(i).date_criteria_start,"onUpdate:modelValue":a[3]||(a[3]=e=>s(i).date_criteria_start=e)},null,8,["modelValue"]),c(I,{class:"",type:"date",tooltip:"Hasta",name:"date_criteria_end",modelValue:s(i).date_criteria_end,"onUpdate:modelValue":a[4]||(a[4]=e=>s(i).date_criteria_end=e)},null,8,["modelValue"])])])):v("",!0),s(w)?(n(),d("div",ke,[t("div",Ve,[c(E,{label:"ESTADO",tooltip:"",placeholder:"Seleccione",name:"status_criteria",modelValue:s(i).status_criteria,"onUpdate:modelValue":a[5]||(a[5]=e=>s(i).status_criteria=e),options:s(K),allowEmpty:!0},null,8,["modelValue","options"])])])):v("",!0),s(k)?(n(),d("div",Ce,[t("div",ze,[c(E,{label:"ESTADO",tooltip:"",placeholder:"Seleccione",name:"user_status_criteria",modelValue:s(i).user_status_criteria,"onUpdate:modelValue":a[6]||(a[6]=e=>s(i).user_status_criteria=e),options:[{label:"ACTIVO",value:"1"},{label:"INACTIVO",value:"0"}],allowEmpty:!1},null,8,["modelValue"])])])):v("",!0),t("div",{class:"flex"},[t("div",{class:""},[t("button",{class:"btn btn-primary shadow-md mr-2",onClick:Q},"Filtrar")]),t("div",{class:""},[t("button",{class:"btn btn-danger shadow-md mr-2",onClick:W},"Limpiar")])])]),c(b,{headers:_.headers,items:_.items,"sort-by":s(j).by,"sort-type":s(j).type,"rows-per-page":100,"hide-rows-per-page":!0,"hide-footer":!0,"table-class-name":"customize-table"},{"header-status":l(({text:e})=>[t("div",Be,[t("p",null,o(e),1),t("button",{onClick:a[7]||(a[7]=m=>w.value=!s(w)),class:y([s(w)?"opacity-100":"opacity-50","hover:opacity-100 text-primary transition"])},[c(f,{size:"20"})],2)])]),"header-user_status":l(({text:e})=>[t("div",Ee,[t("p",null,o(e),1),t("button",{onClick:a[8]||(a[8]=m=>k.value=!s(k)),class:y([s(k)?"opacity-100":"opacity-50","hover:opacity-100 text-primary transition"])},[c(f,{size:"20"})],2)])]),"header-created_at":l(({text:e})=>[t("div",De,[t("p",null,o(e),1),t("button",{onClick:a[9]||(a[9]=m=>V.value=!s(V)),class:y([s(V)?"opacity-100":"opacity-50","hover:opacity-100 text-primary transition"])},[c(f,{size:"20"})],2)])]),"header-actions":l(({text:e})=>[t("div",$e,o(e),1)]),"item-development_activity_image":l(e=>[t("div",Oe,[e.development_activity_image.slice(-3)==="pdf"?(n(),d("span",Se,"PDF")):(n(),d("img",{key:1,src:s(A)+e.development_activity_image,class:"w-10 h-10 rounded-lg object-cover"},null,8,Fe))])]),"item-evidence_participation_image":l(e=>[t("div",Ne,[t("img",{src:s(A)+e.evidence_participation_image,class:"w-10 h-10 rounded-lg object-cover"},null,8,Te)])]),"item-disinterest_apathy":l(({disinterest_apathy:e})=>[L(o(e==1?"SI":"NO"),1)]),"item-role":l(({role:e})=>[t("p",{class:y(e=="Monitor Cultural"?"opacity-100 text-danger transition":e=="Instructor"?"opacity-100 text-success":"opacity-90 transition")},[t("b",null,o(e),1)],2)]),"item-roles":l(({roles:e})=>[(n(!0),d(z,null,P(e,m=>(n(),d("span",Ie,o(m.name),1))),256))]),"item-reintegration":l(({reintegration:e})=>[L(o(e==1?"SI":"NO"),1)]),"item-created_at":l(({created_at:e})=>[t("div",Re,[t("p",null,o(e!=null&&e!=""?s(x)(e).format("DD/MM/YYYY"):""),1)])]),"item-start_time":l(({start_time:e})=>[t("div",Ae,[t("p",null,o(e!=null&&e!=""?s(x)(`2000-01-01 ${e}`).format("hh:mm"):""),1)])]),"item-final_hour":l(({final_hour:e})=>[t("div",je,[t("p",null,o(e!=null&&e!=""?s(x)(`2000-01-01 ${e}`).format("hh:mm"):""),1)])]),"item-final_time":l(({final_time:e})=>[t("div",Me,[t("p",null,o(e!=null&&e!=""?s(x)(`2000-01-01 ${e}`).format("hh:mm"):""),1)])]),"item-place_type":l(e=>[t("div",Ue,[t("p",null,o(s(u).get_option_label("place_types",e.place_type)),1)])]),"item-beneficiary_attrition_factors":l(e=>[t("div",Ye,[t("p",null,o(s(u).get_option_label("beneficiary_attrition_factors",e.beneficiary_attrition_factors)),1)])]),"item-binnacle_id":l(e=>[t("div",Le,[t("p",null,o(s(u).get_option_label("binnacles",e.binnacle_id)),1)])]),"item-user_id":l(e=>[t("div",Pe,[t("p",null,o(s(u).get_option_label("users_table",e.user.id)),1)])]),"item-created_by":l(e=>[t("div",qe,[t("p",null,o(s(u).get_option_label("users_table",e.created_by.id)),1)])]),"item-nac_id":l(e=>[t("div",He,[t("p",null,o(s(u).get_option_label("nacs",e.nac_id)),1)])]),"item-expertise_id":l(e=>[t("div",Ge,[t("p",null,o(s(u).get_option_label("expertises",e.expertise_id)),1)])]),"item-lineament_id":l(e=>[t("div",Je,[t("p",null,o(s(u).get_option_label("lineaments",e.lineament_id)),1)])]),"item-cultural_right_id":l(e=>[t("div",Ke,[t("p",null,o(s(u).get_option_label("cultural_rights",e.cultural_right_id)),1)])]),"item-orientation_id":l(e=>[t("div",Qe,[t("p",null,o(s(u).get_option_label("orientations",e.orientation_id)),1)])]),"item-aspects":l(e=>[t("div",We,[t("ol",Xe,[(n(!0),d(z,null,P(e.aspects,m=>(n(),d("li",null,[t("p",Ze,o(s(u).get_option_label("aspects",m)),1)]))),256))])])]),"item-roles_mm":l(({roles:e})=>[c(q,{type:"roles_display",options:e.map(m=>m.role_id)},null,8,["options"])]),"item-roles_associate":l(({roles_associate:e})=>[c(q,{type:"roles_display",options:e},null,8,["options"])]),"item-datasheet_planning":l(({datasheet_planning:e})=>[c(ce,{datasheet:e.datasheet},null,8,["datasheet"])]),"item-status":l(e=>[t("div",et,[t("p",{class:y(e.status=="REC"?"opacity-100 text-danger transition":e.status=="APRO"?"opacity-100 text-success":"opacity-90 transition")},o(s(me)(e.status)),3)])]),"item-user_status":l(e=>[t("div",tt,[c(de,{onToggle:a[10]||(a[10]=m=>D("change_status")),id:e.id,actual_status:e.status},null,8,["id","actual_status"])])]),"item-has_profile":l(e=>[t("div",st,[t("p",{class:y(e.has_profile=="NO"?"text-danger":"")},[t("b",null,o(e.has_profile),1)],2)])]),"item-change_password":l(e=>[t("div",at,[s(F)?(n(),d("button",{key:0,onClick:m=>Z(e.id),class:"btn btn-success text-white flex flex-nowrap gap-1 items-center"},[c(p,{icon:"Password",class:"w-5 h-5"}),lt],8,it)):v("",!0)])]),"item-actions":l(e=>[t("div",ot,[_.item_see_fnc?(n(),d("div",{key:0,id:`see_${e.id}`},[c(ue,{item:_.item_see_fnc(e),full_view:_.item_see_fullview},null,8,["item","full_view"])],8,nt)):v("",!0),ee(e)||s(F)&&!_.hiddenButton?(n(),d("button",{key:1,onClick:m=>X(e.id),class:"btn btn-primary flex gap-1 items-center"},[c(h,{class:"w-5 h-5"}),ct],8,rt)):v("",!0),s(te)?(n(),d(z,{key:2},[s(u).computed.is_role(s(U).first)&&e.status==="ENREV"?(n(),B(T,{key:0,id:e.id},null,8,["id"])):s(u).computed.is_role(s(U).second)&&e.status==="REV"?(n(),B(T,{key:1,id:e.id},null,8,["id"])):v("",!0)],64)):(n(),d(z,{key:3},[_.management_permissions&&e.status=="ENREV"?(n(),B(T,{key:0,id:e.id},null,8,["id"])):v("",!0)],64)),s(F)&&!_.hiddenButton?(n(),B(_e,{key:4,item:e,label:_.label,"on-delete":_.onDeleteFnc},null,8,["item","label","on-delete"])):v("",!0)])]),_:1},8,["headers","items","sort-by","sort-type"])])}}});export{ft as _};
