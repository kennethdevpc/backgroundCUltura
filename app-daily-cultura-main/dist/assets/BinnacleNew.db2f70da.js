import{m as G,d as K,s as E,H as D,b as W,v as C,c as Y,E as O,r as Z,f as N,g as ee,i as o,w as ae,j as te,t as R,l as e,y as le,k as ie,h as r,ad as oe,F as ne,u as re,q as se,Q as de}from"./index.c93647e1.js";import{p as U}from"./permissions.c73d0fc1.js";import{u as me}from"./index.esm.8471a966.js";import{r as n,a as S,d as L}from"./validations.9fff8c5b.js";import{_ as u}from"./Input.d2784565.js";import{_}from"./Select.7b4ad9bd.js";import{_ as ue}from"./Radio.33857de6.js";import{_ as ce,a as I}from"./Management.8f9978fe.js";import{_ as f}from"./Textarea.8cc31183.js";import{B as _e}from"./binnacles_managers.service.fe412afe.js";import{c as pe}from"./generals.service.ee73141b.js";import{s as ve}from"./scroll.6a87917e.js";import{_ as fe}from"./FormHeader.f0e8692c.js";import"./index.esm.c98934a4.js";import"./useSlug.fdbf14df.js";import"./StateHeader.5dfd959d.js";import"./get_status.6c591513.js";import"./BaseBackButton.438a649f.js";const ge=G("binnacleManagerStore",{state:()=>({form:{activity_date:null,activity_development:null,type:"manager",activity_name:null,binnacle_id:"AC",consecutive:"",cultural_right_id:"",development_activity_image:null,end_of_activity:null,evidence_participation_image:null,experiential_objective:null,expertise_id:"",explain_goals_met:null,final_hour:null,goals_met:null,lineament_id:"",nac_id:"",observations_activity:null,orientation_id:"",place:null,start_activity:null,start_time:null,aforo_file:"",beneficiaries_capacity:""},form_rules:{consecutive:{},binnacle_id:{required:n},activity_name:{alpha:S,required:n},activity_date:{required:n},start_time:{required:n,checkMinMaxHours:L("start_time","final_hour")},final_hour:{required:n,checkMinMaxHours:L("start_time","final_hour")},place:{required:n,alpha:S},type:{},nac_id:{required:n},expertise_id:{required:n},cultural_right_id:{required:n},experiential_objective:{required:n},lineament_id:{required:n},orientation_id:{required:n},goals_met:{required:n},explain_goals_met:{required:n},start_activity:{required:n},activity_development:{required:n},end_of_activity:{required:n},observations_activity:{required:n},development_activity_image:{required:n},evidence_participation_image:{required:n},beneficiaries_capacity:{required:n},aforo_file:{required:n}},form_options:{activation_mode:[{value:"presencial",text:"Presencial"},{value:"virtual",text:"Virtual"}],goals_met:[{value:"si",text:"Si"},{value:"no",text:"No"}]}}),getters:{get_form_rules_computed:V=>({...V.form_rules}),get_transpiled_data(){const{aggregates:V,...m}=this.form;return{...m}}},actions:{}}),be={class:"intro-y box mt-5"},Ve=["disabled"],ye=["onSubmit"],Ie={class:"flex flex-col lg:grid lg:grid-cols-2 xl:grid xl:grid-cols-3 gap-6 justify-evenly mb-8"},Ae={class:"w-full"},xe={class:"flex flex-col lg:grid lg:grid-cols-2 xl:grid xl:grid-cols-3 gap-6 justify-evenly mb-8"},Ee={class:"grid grid-cols-1 gap-6 mb-8"},De={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},Ce={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-6 mb-8"},Oe={class:"flex justify-end"},Ne=["disabled"],ta=K({__name:"BinnacleNew",setup(V){const m=ge(),{form:t,get_form_rules_computed:w,form_options:T}=E(m),s=_e(),A=pe();re();const x=se(),p=D({I:[],II:[]}),j=W(),{options:c}=E(j),M=C(()=>c.value.binnacles.filter(d=>d.value=="AC")),v=C(()=>!!x.params.id),y=async()=>await A.getConsecutive("binnacles","JP").then(()=>{t.value.consecutive=A.data.value}),$=async()=>await s.getOne(x.params.id),g=D({status:"",reject_message:""});Y(async()=>{if(v.value){m.$reset(),i.value.$reset(),await $().catch(()=>{O.not_found_by_id()});const{beneficiaries:d,created_at:a,created_by:l,deleted_at:Re,id:Ue,pec_id:Se,pedagogical_id:Le,reject_message:X,status:q,updated_at:we,user_method_support_id:Te,user_review_instructor_leader_id:je,user_review_manager_cultural_id:Me,user_review_support_follow_id:$e,...Q}=s.data.one;m.$patch(z=>{Object.assign(z.form,{...Q})}),g.status=q,g.reject_message=X}else m.$reset(),i.value.$reset(),await y()});const b=Z(!1),i=me(w,t,{$autoDirty:!0,$lazy:!0}),F=async()=>{await i.value.$validate()?(b.value=!0,v.value?await s.update(s.data.one.id,m.get_transpiled_data,"gestor").finally(()=>{b.value=!1}):await y().finally(()=>{s.create(m.get_transpiled_data,"gestor").then(async a=>{a.data.success&&(p.I=[],p.II=[],m.$reset(),i.value.$reset(),ve(),await y())}).finally(()=>{b.value=!1})})):de.validation()},h=(d,a)=>{if(d)return;const{file:l}=a;t.value.development_activity_image=l},B=(d,a)=>{if(d)return;const{file:l}=a;t.value.evidence_participation_image=l},P=(d,a)=>{if(d)return;const{file:l}=a;t.value.aforo_file=l},k=()=>{t.value.development_activity_image=null},H=()=>{t.value.evidence_participation_image=null},J=()=>{t.value.aforo_file=null};return(d,a)=>(N(),ee(ne,null,[o(fe,{state:{consecutive:e(t).consecutive,status:e(g).status,reject_message:e(g).reject_message}},{default:ae(()=>[te(R(e(v)?`Edici\xF3n de Activaci\xF3n cultural #${e(s).data.one.id}`:"Activaci\xF3n cultural"),1)]),_:1},8,["state"]),e(v)&&e(U).binnaclesManagers.management()?(N(),le(ce,{key:0,class:"mt-5",onSend:a[0]||(a[0]=l=>e(O).methods.send_management("binnacles",e(s).data.one.id,l))})):ie("",!0),r("div",be,[r("fieldset",{disabled:e(U).binnaclesManagers.no_edit()},[r("form",{onSubmit:oe(F,["prevent"]),class:"p-5 border-t border-slate-200/60 dark:border-darkmode-400"},[r("section",Ie,[r("div",Ae,[o(_,{label:"BIT\xC1CORA",tooltip:"Ingrese la bit\xE1cora",name:"binnacle_id",modelValue:e(t).binnacle_id,"onUpdate:modelValue":a[1]||(a[1]=l=>e(t).binnacle_id=l),options:e(M),validator:e(i)},null,8,["modelValue","options","validator"])]),o(u,{type:"text",label:"NOMBRE DE ACTIVIDAD",tooltip:"Ingrese el nombre de la actividad",placeholder:"Nombre de la actividad",name:"activity_name",modelValue:e(t).activity_name,"onUpdate:modelValue":a[2]||(a[2]=l=>e(t).activity_name=l),validator:e(i)},null,8,["modelValue","validator"]),o(u,{type:"date",label:"FECHA DE ACTIVIDAD",tooltip:"Ingrese la fecha de la actividad",placeholder:"Fecha de la actividad",name:"activity_date",modelValue:e(t).activity_date,"onUpdate:modelValue":a[3]||(a[3]=l=>e(t).activity_date=l),validator:e(i)},null,8,["modelValue","validator"]),o(u,{type:"time",label:"HORA INICIO",tooltip:"Ingrese la hora de inicio",placeholder:"Hora inicio",name:"start_time",modelValue:e(t).start_time,"onUpdate:modelValue":a[4]||(a[4]=l=>e(t).start_time=l),validator:e(i)},null,8,["modelValue","validator"]),o(u,{type:"time",label:"HORA FINAL",tooltip:"Ingrese la hora final",placeholder:"Hora final",name:"final_hour",modelValue:e(t).final_hour,"onUpdate:modelValue":a[5]||(a[5]=l=>e(t).final_hour=l),validator:e(i)},null,8,["modelValue","validator"]),o(u,{type:"text",label:"LUGAR",tooltip:"Ingrese el lugar",placeholder:"Lugar",name:"place",modelValue:e(t).place,"onUpdate:modelValue":a[6]||(a[6]=l=>e(t).place=l),validator:e(i)},null,8,["modelValue","validator"])]),r("section",xe,[o(_,{label:"NAC",tooltip:"Ingrese el NAC",placeholder:"Seleccione",name:"nac_id",modelValue:e(t).nac_id,"onUpdate:modelValue":a[7]||(a[7]=l=>e(t).nac_id=l),options:e(c).nacs||null,validator:e(i)},null,8,["modelValue","options","validator"]),o(_,{label:"EXPERTICIA",tooltip:"Ingrese la Experticia",placeholder:"Seleccione",name:"expertise_id",modelValue:e(t).expertise_id,"onUpdate:modelValue":a[8]||(a[8]=l=>e(t).expertise_id=l),options:e(c).expertises||null,validator:e(i)},null,8,["modelValue","options","validator"]),o(_,{label:"DERECHO CULTURAL",tooltip:"Ingrese el Derecho Cultural",placeholder:"Seleccione",name:"cultural_right_id",modelValue:e(t).cultural_right_id,"onUpdate:modelValue":a[9]||(a[9]=l=>e(t).cultural_right_id=l),options:e(c).cultural_rights||null,validator:e(i)},null,8,["modelValue","options","validator"]),o(u,{type:"text",label:"OBJETIVO VIVENCIAL",tooltip:"Ingrese objetivo vivencial",placeholder:"Objetivo vivencial...",name:"experiential_objective",modelValue:e(t).experiential_objective,"onUpdate:modelValue":a[10]||(a[10]=l=>e(t).experiential_objective=l),validator:e(i)},null,8,["modelValue","validator"]),o(_,{label:"LINEAMIENTOS",tooltip:"Ingrese los lineamientos",placeholder:"Seleccione",name:"lineament_id",modelValue:e(t).lineament_id,"onUpdate:modelValue":a[11]||(a[11]=l=>e(t).lineament_id=l),options:e(c).lineaments||null,validator:e(i)},null,8,["modelValue","options","validator"]),o(_,{label:"ORIENTACIONES",tooltip:"Ingrese las orientaciones",placeholder:"Seleccione",name:"orientation_id",modelValue:e(t).orientation_id,"onUpdate:modelValue":a[12]||(a[12]=l=>e(t).orientation_id=l),options:e(c).orientations||null,validator:e(i)},null,8,["modelValue","options","validator"]),o(ue,{label:"\xBFSE CUMPLI\xD3 EL OBJETIVO VIVENCIAL DURANTE LA JORNADA DE ACTIVACI\xD3N CULTURAL?",tooltip:"Objetivo",name:"goals_met",modelValue:e(t).goals_met,"onUpdate:modelValue":a[13]||(a[13]=l=>e(t).goals_met=l),options:e(T).goals_met,validator:e(i)},null,8,["modelValue","options","validator"])]),r("section",Ee,[o(f,{rows:"5",label:"EXPLIQUE EL \xBFPOR QUE?",tooltip:"",placeholder:"Porque...",name:"explain_goals_met",modelValue:e(t).explain_goals_met,"onUpdate:modelValue":a[14]||(a[14]=l=>e(t).explain_goals_met=l),validator:e(i)},null,8,["modelValue","validator"]),o(f,{rows:"5",label:"INICIO",tooltip:"",placeholder:"Inicio...",name:"start_activity",modelValue:e(t).start_activity,"onUpdate:modelValue":a[15]||(a[15]=l=>e(t).start_activity=l),validator:e(i)},null,8,["modelValue","validator"]),o(f,{rows:"5",label:"DESARROLLO",tooltip:"",placeholder:"Desarrollo...",name:"activity_development",modelValue:e(t).activity_development,"onUpdate:modelValue":a[16]||(a[16]=l=>e(t).activity_development=l),validator:e(i)},null,8,["modelValue","validator"]),o(f,{rows:"5",label:"FINAL (REFLEXI\xD3N DE LA JORNADA DE EXPERIMENTACI\xD3N)",tooltip:"",placeholder:"Reflexi\xF3n de la jornada de experimentaci\xF3n...",name:"end_of_activity",modelValue:e(t).end_of_activity,"onUpdate:modelValue":a[17]||(a[17]=l=>e(t).end_of_activity=l),validator:e(i)},null,8,["modelValue","validator"]),o(f,{rows:"5",label:"OBSERVACIONES",tooltip:"",placeholder:"Observaciones...",name:"observations_activity",modelValue:e(t).observations_activity,"onUpdate:modelValue":a[18]||(a[18]=l=>e(t).observations_activity=l),validator:e(i)},null,8,["modelValue","validator"])]),r("section",De,[o(I,{label:"DESARROLLO DE LA JORNADA DE PACTO *",tooltip:"Arrastra una imagen",name:"development_activity_image",ref:"development_activity_image_ref",to_edit:e(s).data.one.development_activity_image,modelValue:e(t).development_activity_image,"onUpdate:modelValue":a[19]||(a[19]=l=>e(t).development_activity_image=l),onAddfile:h,onRemovefile:k,files:e(p).I,validator:e(i)},null,8,["to_edit","modelValue","files","validator"]),o(I,{label:"EVIDENCIA DE PARTICIPACI\xD3N *",tooltip:"Arrastra una imagen",name:"evidence_participation_image",ref:"evidence_participation_image",to_edit:e(s).data.one.evidence_participation_image,modelValue:e(t).evidence_participation_image,"onUpdate:modelValue":a[20]||(a[20]=l=>e(t).evidence_participation_image=l),onAddfile:B,onRemovefile:H,files:e(p).II,validator:e(i)},null,8,["to_edit","modelValue","files","validator"])]),r("div",Ce,[o(I,{label:"DOCUMENTO DEL AFORO *",tooltip:"Arrastra un PDF",name:"development_activity_image",ref:"aforo_file",to_edit:e(s).data.one.aforo_file,modelValue:e(t).aforo_file,"onUpdate:modelValue":a[21]||(a[21]=l=>e(t).aforo_file=l),onAddfile:P,onRemovefile:J,accept_only_pdf:!0,files:e(p).II,validator:e(i)},null,8,["to_edit","modelValue","files","validator"]),o(u,{type:"number",label:"CAPACIDAD (N\xDAMERO DE ASISTENTES) *",tooltip:"Ingrese la capacidad",placeholder:"0...",name:"beneficiaries_capacity",modelValue:e(t).beneficiaries_capacity,"onUpdate:modelValue":a[22]||(a[22]=l=>e(t).beneficiaries_capacity=l),validator:e(i)},null,8,["modelValue","validator"])]),r("div",Oe,[r("button",{disabled:e(b),class:"btn btn-primary",type:"submit"},R(e(v)?"Actualizar":"Ingresar"),9,Ne)])],40,ye)],8,Ve)])],64))}});export{ta as default};
