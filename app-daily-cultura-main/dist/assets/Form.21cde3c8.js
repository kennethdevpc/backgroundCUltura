import{b as F,s as P,r as n,v as G,X as T,D,f as u,g as f,h as d,i as t,ad as q,l as o,k as m,y as U,F as Q,Q as v}from"./index.c93647e1.js";import{r as c}from"./validations.9fff8c5b.js";import{u as X}from"./user.539e8f52.js";import{u as z}from"./index.esm.8471a966.js";import{_ as H}from"./BaseBackButton.438a649f.js";import{_ as g}from"./Input.d2784565.js";import{_ as i}from"./Select.7b4ad9bd.js";import{u as J}from"./profile.service.e6258c5c.js";import{u as K}from"./user.service.5d6ec521.js";import"./index.esm.c98934a4.js";const O={class:"intro-y flex flex-col items-start gap-1 mt-8"},W=d("h2",{class:"intro-y text-lg font-medium mr-auto mt-5"}," Creaci\xF3n de Usuario ",-1),Y={class:"intro-y box py-4 sm:py-5 px-1 sm:px-10 mt-5 pt-4 border-t border-slate-200/60 dark:border-darkmode-400"},Z=["onSubmit"],oo={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4"},eo={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4 mt-4"},lo={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4 mt-4"},ao={key:0,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4 mt-4 w-full intro-x"},ro={key:1,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4 mt-4 w-full intro-x"},to={key:2,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4 mt-4 w-full intro-x"},io={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4 mt-4"},so=d("button",{class:"btn btn-primary mt-5",type:"submit"},"Ingresar",-1),fo={__name:"Form",setup(no){J();const S=K(),b=X(),E=F(),{options:x}=P(E),{form:e,form_rules:w}=P(b),A=n([]),L=n([]),$=n([]),h=n([]),k=n([]),V=n([]),C=n([]),y=n([]),p=(s,l)=>{var a;return(a=l==null?void 0:l.filter(_=>{var j,I;return((I=(j=_==null?void 0:_.roles)==null?void 0:j[0])==null?void 0:I.slug)===s}))==null?void 0:a.map(_=>({label:_.name,value:_.id}))},R=async()=>{await S.usersNoPaginate()},N=async()=>{await R();const s=S.data.no_paginate;L.value=s==null?void 0:s.map(l=>({label:l.name,value:l.id})),$.value=p("gestores_culturales",s),V.value=p("psicosocial",s),C.value=p("apoyo_metodologico",s),y.value=p("apoyo_seguimiento_monitoreo",s),k.value=p("lider_embajador",s),h.value=p("lider_instructor",s)},B=G(()=>e.value.role_id==="gestores_culturales"?{...w.value,psychosocial_id:{required:c},methodological_support_id:{required:c}}:e.value.role_id==="monitor_cultural"||e.value.role_id==="embajador"||e.value.role_id==="instructor"?{...w.value,...e.value.role_id==="embajador"&&{ambassador_leader_id:{required:c}},...e.value.role_id==="instructor"&&{instructor_leader_id:{required:c}},psychosocial_id:{required:c},...e.value.role_id==="monitor_cultural"&&{gestor_id:{required:c}},support_tracing_monitoring_id:{required:c}}:{...w.value}),r=z(B,e);T(()=>{b.$reset(),r.value.$reset()}),D(async()=>{b.$reset(),r.value.$reset(),A.value=x.value.roles,N()});const M=async()=>{if(await r.value.$validate()){const l=await S.create({user:{name:e.value.contractor_full_name,password:e.value.password,email:e.value.email},profile:{contractor_full_name:e.value.contractor_full_name,nac_id:e.value.nac_id,document_number:e.value.document_number,role_id:e.value.role_id,methodological_support_id:e.value.methodological_support_id,psychosocial_id:e.value.psychosocial_id,support_tracing_monitoring_id:e.value.support_tracing_monitoring_id,ambassador_leader_id:e.value.ambassador_leader_id,instructor_leader_id:e.value.instructor_leader_id,gestor_id:e.value.gestor_id}});if(l.status==201&&(v.custom("","Usuario creado exitosamente!","success"),b.$reset(),r.value.$reset(),N()),l.status==400){let a=l.response.data.items;a.email?v.custom("Error al Crear Usuario",a.email.at(0),"error"):a.document_number?v.custom("Error al Crear Usuario",a.document_number.at(0),"error"):v.custom("Error al Crear Usuario","Desconocido?","error")}}else v.validation()};return(s,l)=>(u(),f(Q,null,[d("div",O,[t(H),W]),d("div",Y,[d("form",{onSubmit:q(M,["prevent"]),class:"my-5"},[d("div",oo,[t(g,{value:o(e).contractor_full_name,type:"text",label:"Nombres y apellidos",tooltip:"Ingrese nombres y apellidos",placeholder:"Nombres y apellidos",name:"contractor_full_name",modelValue:o(e).contractor_full_name,"onUpdate:modelValue":l[0]||(l[0]=a=>o(e).contractor_full_name=a),validator:o(r)},null,8,["value","modelValue","validator"]),t(g,{value:o(e).document_number,type:"number",label:"N\xFAmero de identidad",tooltip:"Ingrese el n\xFAmero de identidad",placeholder:"N\xFAmero de identidad",name:"document_number",modelValue:o(e).document_number,"onUpdate:modelValue":l[1]||(l[1]=a=>o(e).document_number=a),validator:o(r)},null,8,["value","modelValue","validator"])]),d("div",eo,[t(g,{value:o(e).password,type:"password",label:"Contrase\xF1a",tooltip:"Ingrese la contrase\xF1a",placeholder:"Contrase\xF1a",name:"password",modelValue:o(e).password,"onUpdate:modelValue":l[2]||(l[2]=a=>o(e).password=a),validator:o(r)},null,8,["value","modelValue","validator"]),t(g,{value:o(e).password_confirm,type:"password",label:"Reescribe contrase\xF1a",tooltip:"Ingrese de nuevo la contrase\xF1a",placeholder:"Reescribe la contrase\xF1a",name:"password_confirm",modelValue:o(e).password_confirm,"onUpdate:modelValue":l[3]||(l[3]=a=>o(e).password_confirm=a),validator:o(r)},null,8,["value","modelValue","validator"])]),d("div",lo,[t(i,{label:"NAC",tooltip:"Ingrese el NAC",placeholder:"Seleccione",name:"nac_id",modelValue:o(e).nac_id,"onUpdate:modelValue":l[4]||(l[4]=a=>o(e).nac_id=a),options:o(x).nacs,validator:o(r)},null,8,["modelValue","options","validator"]),t(i,{label:"Rol",tooltip:"Seleccione el Rol",placeholder:"Seleccione",name:"role_id",modelValue:o(e).role_id,"onUpdate:modelValue":l[5]||(l[5]=a=>o(e).role_id=a),options:o(A),validator:o(r)},null,8,["modelValue","options","validator"])]),o(e).role_id=="gestores_culturales"?(u(),f("div",ao,[t(i,{label:"Psicosocial",tooltip:"Psicosocial",placeholder:"Seleccione",name:"psychosocial_id",modelValue:o(e).psychosocial_id,"onUpdate:modelValue":l[6]||(l[6]=a=>o(e).psychosocial_id=a),options:o(V),validator:o(r)},null,8,["modelValue","options","validator"]),t(i,{label:"Apoyo metodol\xF3gico",tooltip:"Apoyo metodol\xF3gico",placeholder:"Seleccione",name:"methodological_support_id",modelValue:o(e).methodological_support_id,"onUpdate:modelValue":l[7]||(l[7]=a=>o(e).methodological_support_id=a),options:o(C),validator:o(r)},null,8,["modelValue","options","validator"]),t(i,{label:"Apoyo al seguimiento y monitoreo",tooltip:"Apoyo al seguimiento  y monitoreo",placeholder:"Seleccione",name:"support_tracing_monitoring_id",modelValue:o(e).support_tracing_monitoring_id,"onUpdate:modelValue":l[8]||(l[8]=a=>o(e).support_tracing_monitoring_id=a),options:o(y),validator:o(r)},null,8,["modelValue","options","validator"])])):m("",!0),o(e).role_id=="monitor_cultural"?(u(),f("div",ro,[o(e).role_id==="embajador"?(u(),U(i,{key:0,label:"L\xEDder Embajador",tooltip:"L\xEDder Embajador",placeholder:"Seleccione",name:"ambassador_leader_id",modelValue:o(e).ambassador_leader_id,"onUpdate:modelValue":l[9]||(l[9]=a=>o(e).ambassador_leader_id=a),options:o(k),validator:o(r)},null,8,["modelValue","options","validator"])):m("",!0),o(e).role_id==="instructor"?(u(),U(i,{key:1,label:"L\xEDder Instructor",tooltip:"L\xEDder tructor",placeholder:"Seleccione",name:"instructor_leader_id",modelValue:o(e).instructor_leader_id,"onUpdate:modelValue":l[10]||(l[10]=a=>o(e).instructor_leader_id=a),options:o(h),validator:o(r)},null,8,["modelValue","options","validator"])):m("",!0),t(i,{label:"Gestor",tooltip:"Gestor",placeholder:"Seleccione",name:"gestor_id",modelValue:o(e).gestor_id,"onUpdate:modelValue":l[11]||(l[11]=a=>o(e).gestor_id=a),options:o($),validator:o(r)},null,8,["modelValue","options","validator"]),t(i,{label:"Psicosocial",tooltip:"Psicosocial",placeholder:"Seleccione",name:"psychosocial_id",modelValue:o(e).psychosocial_id,"onUpdate:modelValue":l[12]||(l[12]=a=>o(e).psychosocial_id=a),options:o(V),validator:o(r)},null,8,["modelValue","options","validator"]),t(i,{label:"Apoyo al seguimiento y al monitoreo",tooltip:"Apoyo al seguimiento y al monitoreo",placeholder:"Seleccione",name:"support_tracing_monitoring_id",modelValue:o(e).support_tracing_monitoring_id,"onUpdate:modelValue":l[13]||(l[13]=a=>o(e).support_tracing_monitoring_id=a),options:o(y),validator:o(r)},null,8,["modelValue","options","validator"])])):m("",!0),o(e).role_id==="embajador"||o(e).role_id==="instructor"?(u(),f("div",to,[o(e).role_id==="embajador"?(u(),U(i,{key:0,label:"L\xEDder Embajador",tooltip:"L\xEDder Embajador",placeholder:"Seleccione",name:"ambassador_leader_id",modelValue:o(e).ambassador_leader_id,"onUpdate:modelValue":l[14]||(l[14]=a=>o(e).ambassador_leader_id=a),options:o(k),validator:o(r)},null,8,["modelValue","options","validator"])):m("",!0),o(e).role_id==="instructor"?(u(),U(i,{key:1,label:"L\xEDder Instructor",tooltip:"L\xEDder tructor",placeholder:"Seleccione",name:"instructor_leader_id",modelValue:o(e).instructor_leader_id,"onUpdate:modelValue":l[15]||(l[15]=a=>o(e).instructor_leader_id=a),options:o(h),validator:o(r)},null,8,["modelValue","options","validator"])):m("",!0),t(i,{label:"Psicosocial",tooltip:"Psicosocial",placeholder:"Seleccione",name:"psychosocial_id",modelValue:o(e).psychosocial_id,"onUpdate:modelValue":l[16]||(l[16]=a=>o(e).psychosocial_id=a),options:o(V),validator:o(r)},null,8,["modelValue","options","validator"]),t(i,{label:"Apoyo al seguimiento y al monitoreo",tooltip:"Apoyo al seguimiento y al monitoreo",placeholder:"Seleccione",name:"support_tracing_monitoring_id",modelValue:o(e).support_tracing_monitoring_id,"onUpdate:modelValue":l[17]||(l[17]=a=>o(e).support_tracing_monitoring_id=a),options:o(y),validator:o(r)},null,8,["modelValue","options","validator"])])):m("",!0),d("div",io,[t(g,{value:o(e).email,type:"email",label:"Correo",tooltip:"Ingrese el correo",placeholder:"Correo",name:"email",modelValue:o(e).email,"onUpdate:modelValue":l[18]||(l[18]=a=>o(e).email=a),validator:o(r)},null,8,["value","modelValue","validator"])]),so],40,Z)])],64))}};export{fo as default};
