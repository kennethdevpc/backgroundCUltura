import{m as te,d as ae,s as w,a as oe,E as I,b as ie,H as D,v as A,N,c as le,r as se,f as F,g as ne,i as s,w as re,j as de,t as ce,l as e,y as me,k as ue,h as i,ad as _e,F as pe,q as fe,Q as ve}from"./index.c93647e1.js";import{s as ge}from"./scroll.6a87917e.js";import{p as T}from"./permissions.c73d0fc1.js";import{c as be}from"./generals.service.ee73141b.js";import{s as Ve}from"./general_selects.service.211a0396.js";import{b as Ie}from"./strengthening_monitoring.service.a0fc3c69.js";import{u as Ae}from"./index.esm.8471a966.js";import{_ as g}from"./Input.d2784565.js";import{_ as y}from"./Select.7b4ad9bd.js";import{_ as c}from"./Textarea.8cc31183.js";import{_ as ye,a as P}from"./Management.8f9978fe.js";import{r as n,d as j}from"./validations.9fff8c5b.js";import{_ as Ee}from"./FormHeader.f0e8692c.js";import"./useSlug.fdbf14df.js";import"./index.esm.c98934a4.js";import"./StateHeader.5dfd959d.js";import"./get_status.6c591513.js";import"./BaseBackButton.438a649f.js";const Se=te("strengtheningOfMonitorings",{state:()=>({form:{consecutive:"",nac_id:"",role_id:"",user_id:"",activity_date:"",start_time:"",final_hour:"",place:"",strategic_objectives_area:"",purpose_visit:"",topics_covered:"",participants_perception:"",problems_identified:"",recommendations_actions:"",comments_analysis:"",file_1:null,file_2:null,reviewed_by:""},form_rules:{consecutive:{required:n},nac_id:{required:n},role_id:{required:n},user_id:{required:n},activity_date:{required:n},start_time:{required:n,checkMinMaxHours:j("start_time","final_hour")},final_hour:{required:n,checkMinMaxHours:j("start_time","final_hour")},place:{required:n},strategic_objectives_area:{required:n},purpose_visit:{required:n},topics_covered:{required:n},participants_perception:{required:n},problems_identified:{required:n},recommendations_actions:{required:n},comments_analysis:{required:n},file_1:{required:n},file_2:{required:n},reviewed_by:{}}}),actions:{},getters:{}}),xe={class:"intro-y box mt-5"},he=["disabled"],Oe=["onSubmit"],Re={class:"flex flex-col lg:grid lg:grid-cols-2 xl:grid xl:grid-cols-3 gap-6 justify-evenly"},Ce={class:"w-full"},we={class:"w-full"},De={class:"w-full"},Ne={class:"w-full"},Fe={class:"w-full"},Te={class:"w-full"},Pe={class:"w-full"},je={class:"grid grid-cols-1 gap-6 justify-evenly"},Ue=i("h2",{class:"text-xl font-bold uppercase"}," Desarrollo de la Visita ",-1),Le={class:"grid grid-cols-1 gap-6 justify-evenly"},Me=i("h2",{class:"text-xl font-bold uppercase"}," Diagn\xF3stico Inicial ",-1),$e={class:"grid grid-cols-1 gap-6 justify-evenly"},Be={class:"flex flex-col lg:grid lg:grid-cols-2 gap-6 justify-evenly"},He={class:"flex justify-center"},ke=["disabled"],ct=ae({__name:"Form",setup(Ge){const m=Se(),{form:a,form_rules:U}=w(m);oe();const{is_role:L}=I.computed,M=ie(),{options:$}=w(M),d=Ie(),b=be(),l=Ae(U,a,{$autoDirty:!0,$lazy:!0}),_=D({I:[],II:[]}),B=(r,t)=>{if(r)return;const{file:o,filename:v}=t;a.value.file_1=o},H=()=>{a.value.file_1=null},k=(r,t)=>{if(r)return;const{file:o,filename:v}=t;a.value.file_2=o},G=()=>{a.value.file_2=null},E=fe(),u=D({status:"",consecutive:"",reject_message:""}),p=A(()=>!!E.params.id),V=async()=>await b.getConsecutive("strengthening_of_monitorings","FAS").then(()=>{a.value.consecutive=b.data.value,u.consecutive=b.data.value}),q=async()=>await d.getOne(E.params.id),{data:S,getRoles:x,getUsers:h}=Ve,J=A(()=>a.value.nac_id);N(J,async(r,t)=>{r!=t&&await x(r)});const z=A(()=>a.value.role_id);N(z,async(r,t)=>{r!=t&&await h(r)}),le(async()=>{if(p.value){await q().catch(()=>{I.not_found_by_id()});const{created_at:r,deleted_at:t,updated_at:o,status:v,reviewed_id:qe,reject_message:Y,nac_id:O,role_id:R,user_id:K,consecutive:C,development_activity_image:W,evidence_participation_image:X,...Z}=d.data.one;await x(O),await h(R),L("coordinador_seguimiento"),m.$patch(ee=>{Object.assign(ee.form,{...Z,file_1:W,file_2:X,nac_id:O,role_id:R,user_id:K,consecutive:C,status:v})}),Object.assign(u,{status:v,reject_message:Y,consecutive:C})}else await V()});const f=se(!1),Q=async()=>{await l.value.$validate()?(f.value=!0,p.value?await d.update(d.data.one.id,m.form).finally(()=>{f.value=!1}):await V().finally(()=>{d.create(m.form).then(async t=>{t.data.success&&(_.I=[],_.II=[],m.$reset(),l.value.$reset(),ge(),await V())}).finally(()=>{f.value=!1})})):ve.validation()};return(r,t)=>(F(),ne(pe,null,[s(Ee,{state:{consecutive:e(u).consecutive,status:e(u).status,reject_message:e(u).reject_message}},{default:re(()=>[de(ce(e(p)?`Edici\xF3n de Fortalecimiento Seguimiento #${e(d).data.one.id}`:"Fortalecimiento Seguimiento"),1)]),_:1},8,["state"]),e(p)&&e(T).strengthening_monitorings.management()?(F(),me(ye,{key:0,class:"mt-5",onSend:t[0]||(t[0]=o=>e(I).methods.send_management("strengthening_of_monitorings",e(d).data.one.id,o))})):ue("",!0),i("div",xe,[i("fieldset",{disabled:e(T).strengthening_monitorings.no_edit()},[i("form",{onSubmit:_e(Q,["prevent"]),class:"p-5 border-t border-slate-200/60 space-y-8"},[i("section",Re,[i("div",Ce,[s(y,{label:"NAC *",tooltip:"Seleccionar NAC",placeholder:"Seleccione",name:"nac_id",modelValue:e(a).nac_id,"onUpdate:modelValue":t[1]||(t[1]=o=>e(a).nac_id=o),options:e($).nacs,validator:e(l)},null,8,["modelValue","options","validator"])]),i("div",we,[s(y,{disabled:e(a).nac_id=="",label:"ROL *",tooltip:"Seleccionar ROL",placeholder:"Seleccione",name:"role_id",modelValue:e(a).role_id,"onUpdate:modelValue":t[2]||(t[2]=o=>e(a).role_id=o),options:e(S).roles||[],validator:e(l)},null,8,["disabled","modelValue","options","validator"])]),i("div",De,[s(y,{disabled:e(a).role_id=="",label:"NOMBRE *",tooltip:"Seleccionar nombre",placeholder:"Seleccione",name:"user_id",modelValue:e(a).user_id,"onUpdate:modelValue":t[3]||(t[3]=o=>e(a).user_id=o),options:e(S).users||[],validator:e(l)},null,8,["disabled","modelValue","options","validator"])]),i("div",Ne,[s(g,{type:"date",label:"FECHA *",tooltip:"Ingrese la fecha",placeholder:"Fecha",name:"activity_date",modelValue:e(a).activity_date,"onUpdate:modelValue":t[4]||(t[4]=o=>e(a).activity_date=o),validator:e(l)},null,8,["modelValue","validator"])]),i("div",Fe,[s(g,{type:"time",label:"HORA INICIO *",tooltip:"Ingrese la hora de inicio",placeholder:"Hora inicio",name:"start_time",modelValue:e(a).start_time,"onUpdate:modelValue":t[5]||(t[5]=o=>e(a).start_time=o),validator:e(l)},null,8,["modelValue","validator"])]),i("div",Te,[s(g,{type:"time",label:"HORA FINAL *",tooltip:"Ingrese la hora final",placeholder:"Hora final",name:"final_hour",min:e(a).start_time,modelValue:e(a).final_hour,"onUpdate:modelValue":t[6]||(t[6]=o=>e(a).final_hour=o),validator:e(l)},null,8,["min","modelValue","validator"])]),i("div",Pe,[s(g,{type:"text",label:"LUGAR *",tooltip:"Ingrese el nombre del lugar",placeholder:"Nombre del lugar",name:"place",modelValue:e(a).place,"onUpdate:modelValue":t[7]||(t[7]=o=>e(a).place=o),validator:e(l)},null,8,["modelValue","validator"])])]),i("section",je,[Ue,s(c,{label:"OBJETIVOS ESTRAT\xC9GICOS DEL \xC1REA *",tooltip:"Ingrese los objetivos",placeholder:"Objetivos",name:"strategic_objectives_area",modelValue:e(a).strategic_objectives_area,"onUpdate:modelValue":t[8]||(t[8]=o=>e(a).strategic_objectives_area=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"]),s(c,{label:"PROP\xD3SITO DE LA VISITA *",tooltip:"Ingrese el prop\xF3sito",placeholder:"Prop\xF3sito",name:"purpose_visit",modelValue:e(a).purpose_visit,"onUpdate:modelValue":t[9]||(t[9]=o=>e(a).purpose_visit=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"])]),i("section",Le,[Me,s(c,{label:"TEM\xC1TICAS ABORDADAS *",tooltip:"Ingrese las tem\xE1ticas abordadas",placeholder:"Tem\xE1ticas",name:"topics_covered",modelValue:e(a).topics_covered,"onUpdate:modelValue":t[10]||(t[10]=o=>e(a).topics_covered=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"]),s(c,{label:"PERCEPCI\xD3N DE LOS PARTICIPANTES FRENTE A LAS ACTIVIDADES DESARROLLADAS POR EL \xC1REA *",tooltip:"Ingrese la percepci\xF3n",placeholder:"Percepci\xF3n",name:"participants_perception",modelValue:e(a).participants_perception,"onUpdate:modelValue":t[11]||(t[11]=o=>e(a).participants_perception=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"]),s(c,{label:"DIFICULTADES O PROBLEM\xC1TICAS IDENTIFICADAS *",tooltip:"Ingrese las dificultades o problem\xE1ticas",placeholder:"Dificultades o problem\xE1ticas",name:"problems_identified",modelValue:e(a).problems_identified,"onUpdate:modelValue":t[12]||(t[12]=o=>e(a).problems_identified=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"])]),i("section",$e,[s(c,{label:"RECOMENDACIONES Y ACCIONES DE MEJORA PROPUESTAS POR LOS PARTICIPANTES *",tooltip:"Ingrese las recomendaciones y acciones",placeholder:"recomendaciones y acciones",name:"recommendations_actions",modelValue:e(a).recommendations_actions,"onUpdate:modelValue":t[13]||(t[13]=o=>e(a).recommendations_actions=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"]),s(c,{label:"PERCEPCIONES/COMENTARIOS/AN\xC1LISIS FRENTE AL AVANCE DEL PROCESO *",tooltip:"Ingrese percepciones/comentarios/an\xE1lisis",placeholder:"Percepciones/comentarios/an\xE1lisis",name:"comments_analysis",modelValue:e(a).comments_analysis,"onUpdate:modelValue":t[14]||(t[14]=o=>e(a).comments_analysis=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"])]),i("section",Be,[s(P,{label:"DESARROLLO *",tooltip:"Arrastra o selecciona una Imagen",name:"file_1",ref:"file_1ref",to_edit:e(d).data.one.development_activity_image,modelValue:e(a).file_1,"onUpdate:modelValue":t[15]||(t[15]=o=>e(a).file_1=o),onAddfile:B,onRemovefile:H,files:e(_).I,validator:e(l)},null,8,["to_edit","modelValue","files","validator"]),s(P,{label:"EVIDENCIA DE PARTICIPACI\xD3N *",tooltip:"Arrastra o selecciona una Imagen",name:"file_2",ref:"file_2ref",to_edit:e(d).data.one.evidence_participation_image,modelValue:e(a).file_2,"onUpdate:modelValue":t[16]||(t[16]=o=>e(a).file_2=o),onAddfile:k,onRemovefile:G,files:e(_).II,validator:e(l)},null,8,["to_edit","modelValue","files","validator"])]),i("div",He,[i("button",{disabled:e(f),type:"submit",class:"btn btn-primary w-24 ml-2"}," Ingresar ",8,ke)])],40,Oe)],8,he)])],64))}});export{ct as default};
