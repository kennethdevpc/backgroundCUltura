import{m as Z,d as ee,r as te,s as D,b as ae,H as F,v as b,N,c as le,E as U,f as A,g as j,i as s,w as ie,j as oe,t as L,l as e,y as se,k as M,h as n,ad as ne,F as re,q as de,Q as ue}from"./index.c93647e1.js";import{s as me}from"./scroll.6a87917e.js";import{p as S}from"./permissions.c73d0fc1.js";import{c as _e}from"./generals.service.ee73141b.js";import{s as ce}from"./general_selects.service.211a0396.js";import{s as pe}from"./strengtheningSuperMonIns.service.5319b29f.js";import{u as ve}from"./index.esm.8471a966.js";import{_ as x}from"./Input.d2784565.js";import{_ as V}from"./Radio.33857de6.js";import{_ as h}from"./Select.7b4ad9bd.js";import{_ as P}from"./Textarea.8cc31183.js";import{_ as fe,a as T}from"./Management.8f9978fe.js";import{r as o}from"./validations.9fff8c5b.js";import{_ as ge}from"./FormHeader.f0e8692c.js";import"./useSlug.fdbf14df.js";import"./index.esm.c98934a4.js";import"./StateHeader.5dfd959d.js";import"./get_status.6c591513.js";import"./BaseBackButton.438a649f.js";const Ve=Z("strengtheningSuperMonIns",{state:()=>({form:{consecutive:"",revision_date:null,nac_id:null,role_id:null,supervised_user_full_name:null,platform_registration_date:null,address:null,pec_reached_target:null,evidence_participation_image:null,attendance_list:null,validated_pec_time:null,description:null,comments:null,pedagogicals_reached_target:null,development_activity_image:null},form_rules:{consecutive:{required:o},revision_date:{required:o},nac_id:{required:o},role_id:{required:o},supervised_user_full_name:{required:o},platform_registration_date:{required:o},address:{required:o},pec_reached_target:{required:o},pedagogicals_reached_target:{required:o},attendance_list:{required:o},validated_pec_time:{required:o},description:{required:o},comments:{required:o},development_activity_image:{required:o},evidence_participation_image:{required:o}},form_options:{radio:[{value:1,text:"Si"},{value:0,text:"No"}],roles:[{value:14,label:"Monitor"},{value:15,label:"Embajador"},{value:16,label:"Instructor"}]},update_instance:{consecutive:null,status:null,reject_message:null}}),getters:{get_form_rules_computed:_=>({..._.form_rules,attendance_list:_.form.revision_date==="C"||_.form.revision_date==="R"?{required:o}:{},validated_pec_time:_.form.revision_date==="C"||_.form.revision_date==="R"?{required:o}:{}})},actions:{async clear(){this.$state.form.revision_date=null,this.$state.form.nac_id=null,this.$state.form.role_id=null,this.$state.form.supervised_user_full_name=null,this.$state.form.platform_registration_date=null,this.$state.form.address=null,this.$state.form.description=null,this.$state.form.pec_reached_target=null,this.$state.form.pedagogicals_reached_target=null,this.$state.form.development_activity_image=null,this.$state.form.evidence_participation_image=null,this.$state.form.attendance_list=null,this.$state.form.validated_pec_time=null,this.$state.form.comments=null}}}),Ie={class:"intro-y box mt-5"},ye=["disabled"],be=["onSubmit"],Ae={class:"flex flex-col lg:grid lg:grid-cols-2 xl:grid xl:grid-cols-3 gap-6 justify-evenly"},Se={class:"w-full"},xe={class:"w-full"},he={class:"w-full"},Ee={class:"w-full"},Re=n("h2",{class:"text-xl font-bold uppercase"},"Criterios de evaluaci\xF3n",-1),$e={class:"flex flex-col lg:grid lg:grid-cols-2 xl:grid xl:grid-cols-3 gap-6 justify-evenly"},Ce={class:"flex flex-col lg:grid lg:grid-cols-1 xl:grid xl:grid-cols-1 gap-6 justify-evenly mt-5"},Oe={class:"flex flex-col lg:grid lg:grid-cols-2 gap-6 justify-evenly"},we={key:0,class:"flex justify-center"},De=["disabled"],tt=ee({__name:"Form",setup(_){const f=te(!1),u=Ve(),{form:a,form_rules:q,form_options:p}=D(u),B=ae(),{options:k}=D(B),r=pe(),I=_e(),i=ve(q,a,{$autoDirty:!0,$lazy:!0}),g=F({I:[],II:[]}),E=(c,t,l)=>{if(c)return;const{file:d}=t;a.value[l]=d},R=c=>{a.value[c]=null},$=de(),v=F({status:"",consecutive:"",reject_message:""}),m=b(()=>!!$.params.id),y=async()=>await I.getConsecutive("strengthening_super_mons_insts","FSMI").then(()=>{a.value.consecutive=I.data.value,v.consecutive=I.data.value}),G=async()=>await r.getOne($.params.id),{data:H,getRolesCustom:Fe,getRoles:Ne,getUsers:C,getPecs:z}=ce;N(b(()=>a.value.role_id),async()=>{a.value.role_id&&await C(a.value.role_id)}),N(b(()=>a.value.supervised_user_full_name),async()=>{a.value.supervised_user_full_name&&await z(a.value.supervised_user_full_name)}),le(async()=>{if(u.$reset(),i.value.$reset(),m.value){await G().catch(()=>{U.not_found_by_id()});const{created_at:c,deleted_at:t,updated_at:l,status:d,reviewed_id:Ue,reject_message:Q,nac_id:K,role_id:O,supervised_user_full_name:W,consecutive:w,...X}=r.data.one;await C(O),u.$patch(Y=>{Object.assign(Y.form,{...X,nac_id:K,role_id:O,supervised_user_full_name:W,consecutive:w,status:d})}),Object.assign(v,{status:d,reject_message:Q,consecutive:w})}else await y()});const J=async()=>{await i.value.$validate()?(f.value=!0,m.value?await r.update(r.data.one.id,u.form).finally(()=>{f.value=!1}):await y().finally(()=>{r.create(u.form).then(async t=>{t.data.success&&(u.$reset(),await u.clear(),i.value.$reset(),me(),await y(),g.I=[],g.II=[])}).finally(()=>{f.value=!1})})):ue.validation()};return(c,t)=>(A(),j(re,null,[s(ge,{state:{consecutive:e(v).consecutive,status:e(v).status,reject_message:e(v).reject_message}},{default:ie(()=>[oe(L(e(m)?`Edici\xF3n Fortalecimiento a la supervisi\xF3n monitores e instructores #${e(r).data.one.id}`:"Fortalecimiento a la supervisi\xF3n monitores e instructores"),1)]),_:1},8,["state"]),e(m)&&e(S).strengtheningSuperMonIns.management()?(A(),se(fe,{key:0,class:"mt-5",onSend:t[0]||(t[0]=l=>e(U).methods.send_management("strengthening_super_mons_insts",e(r).data.one.id,l))})):M("",!0),n("div",Ie,[n("fieldset",{disabled:e(S).strengtheningSuperMonIns.no_edit()},[n("form",{onSubmit:ne(J,["prevent"]),class:"p-5 border-t border-slate-200/60 space-y-8"},[n("section",Ae,[n("div",Se,[s(x,{type:"date",label:"FECHA DE REVISI\xD3N *",tooltip:"Ingrese la fecha de revisi\xF3n",placeholder:"Fecha",name:"revision_date",modelValue:e(a).revision_date,"onUpdate:modelValue":t[1]||(t[1]=l=>e(a).revision_date=l),validator:e(i)},null,8,["modelValue","validator"])]),n("div",xe,[s(h,{label:"NAC *",tooltip:"Seleccionar NAC",placeholder:"Seleccione",name:"nac_id",modelValue:e(a).nac_id,"onUpdate:modelValue":t[2]||(t[2]=l=>e(a).nac_id=l),options:e(k).nacs,validator:e(i)},null,8,["modelValue","options","validator"])]),n("div",he,[s(h,{label:"ROL *",tooltip:"Seleccionar ROL",placeholder:"Seleccione",name:"role_id",modelValue:e(a).role_id,"onUpdate:modelValue":t[3]||(t[3]=l=>e(a).role_id=l),options:e(p).roles||[],validator:e(i)},null,8,["modelValue","options","validator"])]),n("div",Ee,[s(h,{disabled:e(a).role_id=="",label:"USUARIO SUPERVISADO *",tooltip:"Seleccionar nombre",placeholder:"Seleccione",name:"supervised_user_full_name",modelValue:e(a).supervised_user_full_name,"onUpdate:modelValue":t[4]||(t[4]=l=>e(a).supervised_user_full_name=l),options:e(H).users||[],validator:e(i)},null,8,["disabled","modelValue","options","validator"])])]),Re,n("section",$e,[s(x,{type:"date",label:"FECHA DE REGISTRO EN PLATAFORMA *",tooltip:"Ingresar fecha del PEC",name:"platform_registration_date",modelValue:e(a).platform_registration_date,"onUpdate:modelValue":t[5]||(t[5]=l=>e(a).platform_registration_date=l),validator:e(i)},null,8,["modelValue","validator"]),s(x,{name:"address",type:"text",label:"Direcci\xF3n",modelValue:e(a).address,"onUpdate:modelValue":t[6]||(t[6]=l=>e(a).address=l),validator:e(i)},null,8,["modelValue","validator"]),s(V,{label:"\xBFCUMPLIO? *",tooltip:"",name:"pec_reached_target",modelValue:e(a).pec_reached_target,"onUpdate:modelValue":t[7]||(t[7]=l=>e(a).pec_reached_target=l),options:e(p).radio,validator:e(i),required:""},null,8,["modelValue","options","validator"]),s(V,{label:"FICHA PEDAGOGICA REGISTRADA EN PLATAFORMA *",tooltip:"",name:"pedagogicals_reached_target",modelValue:e(a).pedagogicals_reached_target,"onUpdate:modelValue":t[8]||(t[8]=l=>e(a).pedagogicals_reached_target=l),options:e(p).radio,validator:e(i),required:""},null,8,["modelValue","options","validator"]),s(V,{label:"LISTADO DE ASISTENCIA *",tooltip:"",name:"attendance_list",modelValue:e(a).attendance_list,"onUpdate:modelValue":t[9]||(t[9]=l=>e(a).attendance_list=l),options:e(p).radio,validator:e(i),required:""},null,8,["modelValue","options","validator"]),s(V,{label:"EL MONITOR INICIO LA JORNADA A LA HORA REGISTRADA EN EL PEC? *",tooltip:"",name:"validated_pec_time",modelValue:e(a).validated_pec_time,"onUpdate:modelValue":t[10]||(t[10]=l=>e(a).validated_pec_time=l),options:e(p).radio,validator:e(i),required:""},null,8,["modelValue","options","validator"])]),n("section",Ce,[s(P,{label:"DESCRIPCI\xD3N DE LA JORNADA *",tooltip:"",placeholder:"Descripci\xF3n de la jornada",name:"description",modelValue:e(a).description,"onUpdate:modelValue":t[11]||(t[11]=l=>e(a).description=l),validator:e(i),rows:"3",required:""},null,8,["modelValue","validator"]),s(P,{label:"OBSERVACIONES *",tooltip:"",placeholder:"Observaciones",name:"comments",modelValue:e(a).comments,"onUpdate:modelValue":t[12]||(t[12]=l=>e(a).comments=l),validator:e(i),rows:"3",required:""},null,8,["modelValue","validator"])]),n("section",Oe,[s(T,{label:"EVIDENCIA DEL DESARROLLO *",tooltip:"Arrastra o selecciona una Imagen",name:"development_activity_image",ref:"development_activity_image",to_edit:e(m)&&e(r).data.one!=null?e(r).data.one.development_activity_image:null,modelValue:e(a).development_activity_image,"onUpdate:modelValue":t[13]||(t[13]=l=>e(a).development_activity_image=l),onAddfile:t[14]||(t[14]=(l,d)=>E(l,d,"development_activity_image")),onRemovefile:t[15]||(t[15]=()=>R("development_activity_image")),files:e(g).I,validator:e(i)},null,8,["to_edit","modelValue","files","validator"]),s(T,{label:"EVIDENCIA DE PARTICIPACI\xD3N *",tooltip:"Arrastra o selecciona una Imagen",name:"evidence_participation_image",ref:"evidence_participation_image",to_edit:e(m)&&e(r).data.one!=null?e(r).data.one.evidence_participation_image:null,modelValue:e(a).evidence_participation_image,"onUpdate:modelValue":t[16]||(t[16]=l=>e(a).evidence_participation_image=l),onAddfile:t[17]||(t[17]=(l,d)=>E(l,d,"evidence_participation_image")),onRemovefile:t[18]||(t[18]=()=>R("evidence_participation_image")),files:e(g).II,validator:e(i)},null,8,["to_edit","modelValue","files","validator"])]),e(S).strengtheningSuperMonIns.no_edit()?M("",!0):(A(),j("div",we,[n("button",{disabled:e(f),type:"submit",class:"btn btn-primary w-24 ml-2"},L(e(m)?"Actualizar":"Ingresar"),9,De)]))],40,be)],8,ye)])],64))}});export{tt as default};
