import{d as I,v,r as u,D as N,f as h,g as L,h as l,i as _,l as d,M,F as P,u as B,q as b,E as w,e as y}from"./index.c93647e1.js";import{_ as T}from"./BaseCrud.3eb21af2.js";import{u as U}from"./user.service.5d6ec521.js";import"./DatasheetFormat.bb093e19.js";import"./description.c57d405a.js";import"./useSlug.fdbf14df.js";import"./Input.d2784565.js";import"./Select.7b4ad9bd.js";import"./get_status.6c591513.js";const V=l("h2",{class:"text-lg font-medium mr-auto"},"Usuarios",-1),F={class:"intro-y box p-5 mt-5"},k={class:"flex items-center justify-center p-2 text-base"},X=I({__name:"Index",setup(G){const C=B(),E=b(),i=U(),g=v(()=>String(E.name).split(".")[0]),O=()=>{C.push({name:`${g.value}.create`})};async function x(e){await i.destroy(e),r()}const A=[{text:"#",value:"id"},{text:"NOMBRE",value:"name"},{text:"EMAIL",value:"email"},{text:"ROLES",value:"roles"},{text:"ESTADO",value:"user_status"},{text:"FECHA DE CREACI\xD3N",value:"created_at"},{text:"AJUSTES",value:"change_password"},{text:"ACCIONES",value:"actions"}],m=u([]),S=e=>{const{id:a}=e,n=v(()=>{const t=e.profile;return t!=null?t:"Sin perfil"}),s=u([]);return e.roles.forEach(t=>{t.permissions.forEach(c=>{s.value.push({NOMBRE:c.name,SLUG:c.slug,CONTROLADOR:c.controller,DESCRIPCI\u00D3N:c.description})})}),{id:a,consecutive:`Usuario-${a}`,sections:{general:{title:"Datos Generales",fields:{NOMBRE:e.name,EMAIL:e.email,ESTADO:e.status==1?"ACTIVO":"INACTIVO"}},profile:{title:"Perfil",fields:{ID:n.value.id,"NOMBRE COMPLETO":n.value.contractor_full_name,C\u00C9DULA:n.value.document_number,NAC:w.get_option_label("nacs",n.value.nac_id)}},roles:{title:"Roles",fields:{"ROLES (TABLA)":e.roles.map(t=>({NOMBRE:t.name,SLUG:t.slug,DESCRIPCI\u00D3N:t.description,"ACCESO COMPLETO":t["full-access"]=="yes"?"SI":"NO",PUBLICO:t.public==1?"SI":"NO"}))}},permissions:{title:"Permisos",fields:{"PERMISOS (TABLA)":s.value.length>0?s.value:"?"}}}}};let o=u(1),f=u(0);const p=u({});async function r(){const e=Object.keys(p.value).length?new URLSearchParams(p.value):null;await i.get(o.value,e),m.value=i.data.all,f.value=i.data.count_page}function R(e){o.value=1,p.value=e,r()}function D(){r()}return N(async()=>{await r(),m.value.map(e=>({...e,actions:"Acciones"}))}),(e,a)=>{const n=y("v-pagination");return h(),L(P,null,[l("div",{class:"intro-y flex flex-col sm:flex-row items-center mt-8"},[V,l("div",{class:"w-full sm:w-auto flex mt-4 sm:mt-0"},[l("button",{class:"btn btn-primary shadow-md mr-2",onClick:O}," Crear usuario ")])]),l("div",F,[l("div",k,[_(n,{modelValue:d(o),"onUpdate:modelValue":[a[0]||(a[0]=s=>M(o)?o.value=s:o=s),D],pages:d(f),"range-size":1,"active-color":"#DCEDFF"},null,8,["modelValue","pages"])]),_(T,{headers:A,items:d(m),item_see_fnc:S,label:"Usuarios","on-delete-fnc":x,onChange_status:a[1]||(a[1]=s=>r()),onChange_filter:R,server_options:{page:1,rowsPerPage:15}},null,8,["items"])])],64)}}});export{X as default};
