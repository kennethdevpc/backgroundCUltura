import{H as y,r as c,u as N,P as f,K as F,Q as S,d as M,au as T,v as P,D as b,f as C,g as I,h as u,l,k as w,i as x,M as G,F as V,q as B,E as $,e as H}from"./index.c93647e1.js";import{_ as k}from"./BaseCrud.3eb21af2.js";import{p as U}from"./permissions.c73d0fc1.js";import"./DatasheetFormat.bb093e19.js";import"./description.c57d405a.js";import"./user.service.5d6ec521.js";import"./useSlug.fdbf14df.js";import"./Input.d2784565.js";import"./Select.7b4ad9bd.js";import"./get_status.6c591513.js";const j="methodologicalMonitorings",z="api/v1";function q(){const m=y({all:[],one:{},no_paginate:[],count_page:0});N();const _=c("");return{data:m,errors:_,get:async(g,d=null)=>{var p;try{f(!0);let a=Boolean(d)?`?page=${g}&${d}`:`?page=${g}`,t=await F.get(`/${z}/${j}${a}`).finally(()=>{f(!1)});t.status===200&&(m.all=t.data.items,m.count_page=t.data.count_page)}catch(a){S.custom_validation((p=a.response.data.error)!=null?p:a.response.data.message)}}}}const Z={class:"intro-y flex flex-col sm:flex-row items-center mt-8"},J=u("h2",{class:"text-lg font-medium mr-auto"},"Seguimiento metodol\xF3gico",-1),K={key:0,class:"w-full sm:w-auto flex mt-4 sm:mt-0"},Q={class:"intro-y box p-5 mt-5"},W={class:"flex items-center justify-center p-2 text-base"},le=M({__name:"Index",setup(m){const{hasPermission:_}=T(),o=q(),g=N(),d=B(),p=P(()=>String(d.name).split(".")[0]),a=()=>{g.push({name:`${p.value}.create`})},t=c([]);let n=c(1),A=c(0);const v=c({});async function i(){const e=Object.keys(v.value).length?new URLSearchParams(v.value):null;await o.get(n.value,e).then(()=>{t.value=o.data.all,A.value=o.data.count_page})}function O(e){n.value=1,v.value=e,i()}function h(){i()}async function R(e){o.destroy(e),await i()}const L=[{text:"CONSECUTIVO",value:"consecutive"},{text:"SEGUIMIENTO",value:"datasheet"},{text:"NAC",value:"nac.name"},{text:"ROLES",value:"roles_mm"},{text:"FECHA REALIZACI\xD3N",value:"date_realization"},{text:"FECHA INICIAL RANGO",value:"date_planning_ini"},{text:"FECHA FINAL RANGO",value:"date_planning_fin"},{text:"CREADO POR",value:"user.name"},{text:"CREACI\xD3N",value:"created_at"},{text:"ESTADO",value:"status"},{text:"ACCIONES",value:"actions"}],D=e=>{const{id:s,consecutive:E}=e;return{id:s,consecutive:E,sections:{general:{title:"Datos Generales",fields:{NAC:e.nac.name,ORIENTACI\u00D3N:e.orientation.name,"FECHA REALIZACI\xD3N":e.date_realization,"FECHA INICIAL":e.date_planning_ini,"FECHA FINAL":e.date_planning_fin,"OBJETIVO DEL PROCESO":e.objective_process,OBSERVACIONES:e.comments,"TIPO DE FORTALECIMIENTO":e.strengthening_type_name,"COMENTARIOS DEL FORTALECIMIENTO":e.strengthening_comments,"TEM\xC1TICAS A FORTALECER SEG\xDAN ROL":e.topics_to_strengthened}},multimedia:{title:"Multimedia",fields:{"IMAGEN DEL LUGAR":e.development_activity_image,"IMAGEN DEL LUGAR 2":e.evidence_participation_image}},aggregates:{title:"Agregados",fields:{"Asistentes (TABLA)":e.aggregates.map(r=>({NOMBRE:$.get_option_label("users_table",r.aggregate_id)}))}}}}};return b(async()=>{await i(),t.value.map(e=>({...e,actions:"Acciones"}))}),(e,s)=>{const E=H("v-pagination");return C(),I(V,null,[u("div",Z,[J,l(_)("methodologicalMonitorings.create")?(C(),I("div",K,[u("button",{class:"btn btn-primary shadow-md mr-2",onClick:a}," Crear un Seguimiento ")])):w("",!0)]),u("div",Q,[u("div",W,[x(E,{modelValue:l(n),"onUpdate:modelValue":[s[0]||(s[0]=r=>G(n)?n.value=r:n=r),h],pages:l(A),"range-size":1,"active-color":"#DCEDFF"},null,8,["modelValue","pages"])]),x(k,{headers:L,items:l(t),item_see_fnc:D,label:"la inscripci\xF3n",management_permissions:l(U).inscriptions.crud_management(),"on-delete-fnc":R,onChange_status:s[1]||(s[1]=r=>i()),onChange_filter:O,server_options:{page:1,rowsPerPage:15}},null,8,["items","management_permissions"])])],64)}}});export{le as default};
