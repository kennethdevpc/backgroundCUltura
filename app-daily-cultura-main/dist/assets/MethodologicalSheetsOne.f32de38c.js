import{d as L,v as w,r as d,D as F,O as s,f,g as v,h as c,l,k as b,i as g,M as $,F as P,u as Y,q as V,E as i,e as B}from"./index.c93647e1.js";import{_ as U}from"./BaseCrud.3eb21af2.js";import{p as C}from"./permissions.c73d0fc1.js";import{u as k}from"./methodologicalSheetsOne.service.ccdd648f.js";import{c as j}from"./generals.service.ee73141b.js";import"./DatasheetFormat.bb093e19.js";import"./description.c57d405a.js";import"./user.service.5d6ec521.js";import"./useSlug.fdbf14df.js";import"./Input.d2784565.js";import"./Select.7b4ad9bd.js";import"./get_status.6c591513.js";const G={class:"intro-y flex flex-col sm:flex-row items-center mt-5"},H=c("h2",{class:"text-lg font-medium mr-auto"}," Ficha Metodol\xF3gica de Planeaci\xF3n ",-1),J={key:0,class:"w-full sm:w-auto flex mt-4 sm:mt-0"},q={class:"intro-y box mt-5 p-5"},z={class:"flex items-center justify-center p-2 text-base"},le=L({__name:"MethodologicalSheetsOne",setup(X){const _=k(),E=Y(),h=V(),A=j(),{computed:{is_role:O,is_admin:x}}=i,R=w(()=>String(h.name).split(".")[0]),M=()=>{E.push({name:`${R.value}.create`})};async function D(e){await _.destroy(e),r()}let n=d(1),p=d(0);const m=d({}),I=[{text:"CONSECUTIVO",value:"consecutive"},{text:"FICHA",value:"datasheet",width:140},{text:"CREADO POR",value:"created_by.name"},{text:"FECHA",value:"date",width:200},{text:"SEMILLERO",value:"semillero_name"},{text:"GRUPO",value:"group.name"},{text:"LINEAMIENTO",value:"lineament_id"},{text:"ORIENTACI\xD3N",value:"orientation_id"},{text:"CREACI\xD3N",value:"created_at"},{text:"ESTADO",value:"status"},{text:"ACCIONES",value:"actions"}],u=d([]);async function r(){const e=Object.keys(m.value).length?new URLSearchParams(m.value):null;let t;return O("lider_instructor")||x()?t=await _.get(n.value,e):t=await A.getAllDataCreatedBy("methodological_sheets_one",n.value,e),p.value=t.data.count_page,t.data.items}async function S(e){n.value=1,m.value=e;const t=await r();u.value=t.map(a=>{const o=`${s(a.date_ini).format("MMM-D")} a ${s(a.date_fin).format("MMM-D")} de ${s(a.date_fin).format("YYYY")}`,y=`Ficha ${a.id}`;return{...a,date:o,ficha:y,actions:"Acciones"}})}async function N(){const e=await r();u.value=e.map(t=>{const a=`${s(t.date_ini).format("MMM-D")} a ${s(t.date_fin).format("MMM-D")} de ${s(t.date_fin).format("YYYY")}`,o=`Ficha ${t.id}`;return{...t,date:a,ficha:o,actions:"Acciones"}})}const T=e=>{const{id:t,consecutive:a}=e;return{id:t,consecutive:a,sections:{general:{title:"Datos Generales",fields:{"NOMBRE DEL SEMILLERO CULTURAL":e.semillero_name,FECHA:e.date,GRUPO:e.group.name,FILTRO:i.get_option_label("filter_level",e.filter_level),"DERECHO CULTURAL":i.get_option_label("cultural_rights",e.cultural_right_id),LINEAMIENTOS:i.get_option_label("lineaments",e.lineament_id),ORIENTACIONES:i.get_option_label("orientations",e.orientation_id),VALOR:i.get_option_label("values",e.value),"EXPERTICIA ART\xCDSTICA A TRABAJAR":e.worked_expertise,"CARACTER\xCDSTICAS DEL PROCESO A TRABAJAR":e.characteristics_process,"OBJETIVO DEL PROCESO":e.objective_process,OBSERVACIONES:e.comments}}}}};return F(async()=>{const e=await r();u.value=e.map(t=>{const a=`${s(t.date_ini).format("MMM-D")} a ${s(t.date_fin).format("MMM-D")} de ${s(t.date_fin).format("YYYY")}`,o=`Ficha ${t.id}`;return{...t,date:a,ficha:o,actions:"Acciones"}})}),(e,t)=>{const a=B("v-pagination");return f(),v(P,null,[c("div",G,[H,l(C).sheetsOne.create()?(f(),v("div",J,[c("button",{class:"btn btn-primary shadow-md mr-2",onClick:M}," Crear ficha ")])):b("",!0)]),c("div",q,[c("div",z,[g(a,{modelValue:l(n),"onUpdate:modelValue":[t[0]||(t[0]=o=>$(n)?n.value=o:n=o),N],pages:l(p),"range-size":1,"active-color":"#DCEDFF"},null,8,["modelValue","pages"])]),g(U,{headers:I,item_see_fnc:T,items:l(u),management_permissions:l(C).sheetsOne.crud_management(),label:"la ficha metodol\xF3gica","on-delete-fnc":D,onChange_status:t[1]||(t[1]=o=>r()),onChange_filter:S,server_options:{page:1,rowsPerPage:15}},null,8,["items","management_permissions"])])],64)}}});export{le as default};
