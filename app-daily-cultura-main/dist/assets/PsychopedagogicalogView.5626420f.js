import{d as y,v as P,r as m,D as T,f as E,g as A,h as r,l as i,k as b,i as O,M,F as B,u as F,q as U,E as d,e as w}from"./index.c93647e1.js";import{p as V}from"./psychopedagogicalog.service.a2ac598b.js";import{p as v}from"./permissions.c73d0fc1.js";import{_ as k}from"./BaseCrudPDF.669a02c7.js";import"./DatasheetFormat.bb093e19.js";import"./description.c57d405a.js";import"./user.service.5d6ec521.js";import"./useSlug.fdbf14df.js";import"./Input.d2784565.js";import"./Select.7b4ad9bd.js";import"./get_status.6c591513.js";const H={class:"intro-y flex flex-col sm:flex-row items-center mt-8"},G=r("h2",{class:"text-lg font-medium mr-auto"},"Bit\xE1cora Psicopedagogica",-1),j={key:0,class:"w-full sm:w-auto flex mt-4 sm:mt-0"},$={class:"intro-y box mt-5 p-5"},J={class:"flex items-center justify-center p-2 text-base"},oe=y({__name:"PsychopedagogicalogView",setup(q){const c=V(),f=F(),R=U(),N=P(()=>String(R.name).split(".")[0]),C=()=>{f.push({name:`${N.value}.create`})};async function I(e){await c.destroy(e).then(()=>{o()})}const x=[{text:"CONSECUTIVO",value:"consecutive"},{text:"CREADO POR",value:"user.name"},{text:"FECHA",value:"date"},{text:"NAC",value:"nac.name"},{text:"HORA INICIO",value:"start_time"},{text:"HORA FINAL",value:"final_time"},{text:"ESTADO",value:"status"},{text:"ACCIONES",value:"actions"}],D=e=>{const{id:s,consecutive:_}=e,n=e.assistants.map(t=>({NOMBRE:t.assistant_name,CEDULA:t.assistant_document_number,CARGO:t.assistant_position,TELEFONO:t.assistant_phone,EMAIL:t.assistant_email,NAC:d.get_option_label("nacs",t.nac_id)})),S=e.monitors.map(t=>{const l=d.get_monitor_by_id(t.monitor_id);if(l!="No encontrad@")return{ID:l.id,NOMBRE:l.monitor_fullname,CEDULA:l.document_number}});return{id:s,consecutive:_,sections:{general:{title:"Datos Generales",fields:{FECHA:e.date,NAC:e.nac.name,"HORA INICIO":e.start_time,"HORA FINAL":e.final_time,"NOMBRE DE LA PERSONA ATENDIDA":e.person_served_name,"NOMBRE DEL MONITOR CULTURAL":d.get_option_label("nacs",e.monitor_id),OBJETIVO:e.objective,DESARROLLO:e.development,"CONCLUCIONES, REFLEXIONES Y COMPROMISOS DE LA JORNADA":e.conclusions_reflections_commitments,"REPORTE DE ALERTA PARA HACER SEGUIMIENTO":e.alert_reporting_tracking,"IMAGEN PRUEBA DEL DESARROLLO":e.development_activity_image,"IMAGEN PRUEBA DE PARTICIPACI\xD3N":e.evidence_participation_image}},asistances:{title:"Datos de asistencia",fields:{ASISTENTES:n,"MONITORES ASISTENTES":S}}}}},u=m([]);let a=m(1),g=m(0);const p=m({});async function o(){const e=Object.keys(p.value).length?new URLSearchParams(p.value):null;await c.get(a.value,e),u.value=c.data.all,g.value=c.data.count_page}function h(e){a.value=1,p.value=e,o()}function L(){o()}return T(async()=>{await o(),u.value.map(e=>({...e,actions:"Acciones"}))}),(e,s)=>{const _=w("v-pagination");return E(),A(B,null,[r("div",H,[G,i(v).psychopedagogicallogs.create()?(E(),A("div",j,[r("button",{class:"btn btn-primary shadow-md mr-2",onClick:C}," Crear una bit\xE1cora psicopedagogica ")])):b("",!0)]),r("div",$,[r("div",J,[O(_,{modelValue:i(a),"onUpdate:modelValue":[s[0]||(s[0]=n=>M(a)?a.value=n:a=n),L],pages:i(g),"range-size":1,"active-color":"#DCEDFF"},null,8,["modelValue","pages"])]),O(k,{headers:x,items:i(u),label:"la bit\xE1cora psicopedag\xF3gica",item_see_fnc:D,management_permissions:i(v).psychopedagogicallogs.crud_management(),"on-delete-fnc":I,onChange_status:s[1]||(s[1]=n=>o()),onChange_filter:h,server_options:{page:1,rowsPerPage:15}},null,8,["items","management_permissions"])])],64)}}});export{oe as default};
