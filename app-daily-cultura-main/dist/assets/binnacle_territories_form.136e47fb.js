import{m as te,d as oe,s as D,a as ie,E,b as le,r as se,H as N,v as ne,J as re,N as T,c as de,f as F,g as ce,i as s,w as me,j as ue,t as _e,l as e,y as pe,k as fe,h as i,ad as ve,F as be,q as ge,Q as Ve}from"./index.c93647e1.js";import{s as Ie}from"./scroll.6a87917e.js";import{p as b}from"./permissions.c73d0fc1.js";import{c as ye}from"./generals.service.ee73141b.js";import{s as Ee}from"./general_selects.service.211a0396.js";import{b as Ae}from"./binnacle_territories.service.3e4eec66.js";import{u as Se}from"./index.esm.8471a966.js";import{_ as g}from"./Input.d2784565.js";import{_ as A}from"./Select.7b4ad9bd.js";import{_ as c}from"./Textarea.8cc31183.js";import{_ as xe,a as P}from"./Management.8f9978fe.js";import{r as n,d as j}from"./validations.9fff8c5b.js";import{_ as Re}from"./FormHeader.f0e8692c.js";import"./useSlug.fdbf14df.js";import"./index.esm.c98934a4.js";import"./StateHeader.5dfd959d.js";import"./get_status.6c591513.js";import"./BaseBackButton.438a649f.js";const Ce=te("binnacle_territories",{state:()=>({form:{consecutive:"",nac_id:"",role_id:"",user_id:"",activity_date:"",start_time:"",final_hour:"",place:"",strategic_objectives_area:"",purpose_visit:"",topics_covered:"",participants_perception:"",problems_identified:"",recommendations_actions:"",comments_analysis:"",file_1:null,file_2:null,reviewed_by:""},form_rules:{consecutive:{required:n},nac_id:{required:n},role_id:{required:n},user_id:{required:n},activity_date:{required:n},start_time:{required:n,checkMinMaxHours:j("start_time","final_hour")},final_hour:{required:n,checkMinMaxHours:j("start_time","final_hour")},place:{required:n},strategic_objectives_area:{required:n},purpose_visit:{required:n},topics_covered:{required:n},participants_perception:{required:n},problems_identified:{required:n},recommendations_actions:{required:n},comments_analysis:{required:n},file_1:{required:n},file_2:{required:n},reviewed_by:{}}}),actions:{},getters:{}}),Oe={class:"intro-y box mt-5"},he=["disabled"],we=["onSubmit"],De={class:"flex flex-col lg:grid lg:grid-cols-2 xl:grid xl:grid-cols-3 gap-6 justify-evenly"},Ne={class:"w-full"},Te={class:"w-full"},Fe={class:"w-full"},Pe={class:"w-full"},je={class:"w-full"},Ue={class:"w-full"},Le={class:"w-full"},Me={class:"grid grid-cols-1 gap-6 justify-evenly"},$e=i("h2",{class:"text-xl font-bold uppercase"}," Desarrollo de la Visita ",-1),Be={class:"grid grid-cols-1 gap-6 justify-evenly"},He=i("h2",{class:"text-xl font-bold uppercase"}," Diagn\xF3stico Inicial ",-1),ke={class:"grid grid-cols-1 gap-6 justify-evenly"},Ge={class:"flex flex-col lg:grid lg:grid-cols-2 gap-6 justify-evenly"},Je={class:"flex justify-center"},qe=["disabled"],_a=oe({__name:"binnacle_territories_form",setup(ze){const m=Ce(),{form:t,form_rules:U}=D(m);ie();const{is_role:V}=E.computed,L=le(),{options:M}=D(L),d=Ae(),I=ye(),_=se(!1),l=Se(U,t,{$autoDirty:!0,$lazy:!0}),p=N({I:[],II:[]}),$=(r,a)=>{if(r)return;const{file:o,filename:v}=a;t.value.file_1=o},B=()=>{t.value.file_1=null},H=(r,a)=>{if(r)return;const{file:o,filename:v}=a;t.value.file_2=o},k=()=>{t.value.file_2=null},S=ge(),u=N({status:"",consecutive:"",reject_message:""}),f=ne(()=>!!S.params.id),y=async()=>await I.getConsecutive("binnacle_territories","BV").then(()=>{t.value.consecutive=I.data.value,u.consecutive=I.data.value}),G=async()=>await d.getOne(S.params.id),{data:x,getRoles:R,getUsers:C}=Ee,{nac_id:J,role_id:q}=re(t.value);T(J,async(r,a)=>{r!=a&&await R(r)}),T(q,async(r,a)=>{r!=a&&await C(r)}),de(async()=>{if(f.value){await G().catch(()=>{E.not_found_by_id()});const{created_at:r,deleted_at:a,updated_at:o,status:v,reviewed_id:Qe,reject_message:K,nac_id:O,role_id:h,user_id:W,consecutive:w,development_activity_image:X,evidence_participation_image:Z,...ee}=d.data.one;await R(O),await C(h),V("subdireccion"),m.$patch(ae=>{Object.assign(ae.form,{...ee,file_1:X,file_2:Z,nac_id:O,role_id:h,user_id:W,consecutive:w,status:v})}),Object.assign(u,{status:v,reject_message:K,consecutive:w})}else await y()});const z=async()=>{await l.value.$validate()?(_.value=!0,f.value?await d.update(d.data.one.id,m.form).finally(()=>{_.value=!1}):await y().finally(()=>{d.create(m.form).then(async a=>{a.data.success&&(p.I=[],p.II=[],m.$reset(),l.value.$reset(),Ie(),await y())}).finally(()=>{_.value=!1})})):Ve.validation()},Q=V("subdireccion")?b.subdireccion.management():b.direccion.management(),Y=V("subdireccion")?b.subdireccion.no_edit():b.direccion.no_edit();return(r,a)=>(F(),ce(be,null,[s(Re,{state:{consecutive:e(u).consecutive,status:e(u).status,reject_message:e(u).reject_message}},{default:me(()=>[ue(_e(e(f)?`Edici\xF3n de visita a territorio #${e(d).data.one.id}`:"Visita a territorio"),1)]),_:1},8,["state"]),e(f)&&e(Q)?(F(),pe(xe,{key:0,class:"mt-5",onSend:a[0]||(a[0]=o=>e(E).methods.send_management("binnacle_territories",e(d).data.one.id,o))})):fe("",!0),i("div",Oe,[i("fieldset",{disabled:e(Y)},[i("form",{onSubmit:ve(z,["prevent"]),class:"p-5 border-t border-slate-200/60 space-y-8"},[i("section",De,[i("div",Ne,[s(A,{label:"NAC *",tooltip:"Seleccionar NAC",placeholder:"Seleccione",name:"nac_id",modelValue:e(t).nac_id,"onUpdate:modelValue":a[1]||(a[1]=o=>e(t).nac_id=o),options:e(M).nacs,validator:e(l)},null,8,["modelValue","options","validator"])]),i("div",Te,[s(A,{disabled:e(t).nac_id=="",label:"ROL *",tooltip:"Seleccionar ROL",placeholder:"Seleccione",name:"role_id",modelValue:e(t).role_id,"onUpdate:modelValue":a[2]||(a[2]=o=>e(t).role_id=o),options:e(x).roles||[],validator:e(l)},null,8,["disabled","modelValue","options","validator"])]),i("div",Fe,[s(A,{disabled:e(t).role_id=="",label:"NOMBRE *",tooltip:"Seleccionar nombre",placeholder:"Seleccione",name:"user_id",modelValue:e(t).user_id,"onUpdate:modelValue":a[3]||(a[3]=o=>e(t).user_id=o),options:e(x).users||[],validator:e(l)},null,8,["disabled","modelValue","options","validator"])]),i("div",Pe,[s(g,{type:"date",label:"FECHA *",tooltip:"Ingrese la fecha",placeholder:"Fecha",name:"activity_date",modelValue:e(t).activity_date,"onUpdate:modelValue":a[4]||(a[4]=o=>e(t).activity_date=o),validator:e(l)},null,8,["modelValue","validator"])]),i("div",je,[s(g,{type:"time",label:"HORA INICIO *",tooltip:"Ingrese la hora de inicio",placeholder:"Hora inicio",name:"start_time",modelValue:e(t).start_time,"onUpdate:modelValue":a[5]||(a[5]=o=>e(t).start_time=o),validator:e(l)},null,8,["modelValue","validator"])]),i("div",Ue,[s(g,{type:"time",label:"HORA FINAL *",tooltip:"Ingrese la hora final",placeholder:"Hora final",name:"final_hour",min:e(t).start_time,modelValue:e(t).final_hour,"onUpdate:modelValue":a[6]||(a[6]=o=>e(t).final_hour=o),validator:e(l)},null,8,["min","modelValue","validator"])]),i("div",Le,[s(g,{type:"text",label:"LUGAR *",tooltip:"Ingrese el nombre del lugar",placeholder:"Nombre del lugar",name:"place",modelValue:e(t).place,"onUpdate:modelValue":a[7]||(a[7]=o=>e(t).place=o),validator:e(l)},null,8,["modelValue","validator"])])]),i("section",Me,[$e,s(c,{label:"OBJETIVOS ESTRAT\xC9GICOS DEL \xC1REA *",tooltip:"Ingrese los objetivos",placeholder:"Objetivos",name:"strategic_objectives_area",modelValue:e(t).strategic_objectives_area,"onUpdate:modelValue":a[8]||(a[8]=o=>e(t).strategic_objectives_area=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"]),s(c,{label:"PROP\xD3SITO DE LA VISITA *",tooltip:"Ingrese el prop\xF3sito",placeholder:"Prop\xF3sito",name:"purpose_visit",modelValue:e(t).purpose_visit,"onUpdate:modelValue":a[9]||(a[9]=o=>e(t).purpose_visit=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"])]),i("section",Be,[He,s(c,{label:"TEM\xC1TICAS ABORDADAS *",tooltip:"Ingrese las tem\xE1ticas abordadas",placeholder:"Tem\xE1ticas",name:"topics_covered",modelValue:e(t).topics_covered,"onUpdate:modelValue":a[10]||(a[10]=o=>e(t).topics_covered=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"]),s(c,{label:"PERCEPCI\xD3N DE LOS PARTICIPANTES FRENTE A LAS ACTIVIDADES DESARROLLADAS POR EL \xC1REA *",tooltip:"Ingrese la percepci\xF3n",placeholder:"Percepci\xF3n",name:"participants_perception",modelValue:e(t).participants_perception,"onUpdate:modelValue":a[11]||(a[11]=o=>e(t).participants_perception=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"]),s(c,{label:"DIFICULTADES O PROBLEM\xC1TICAS IDENTIFICADAS *",tooltip:"Ingrese las dificultades o problem\xE1ticas",placeholder:"Dificultades o problem\xE1ticas",name:"problems_identified",modelValue:e(t).problems_identified,"onUpdate:modelValue":a[12]||(a[12]=o=>e(t).problems_identified=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"])]),i("section",ke,[s(c,{label:"RECOMENDACIONES Y ACCIONES DE MEJORA PROPUESTAS POR LOS PARTICIPANTES *",tooltip:"Ingrese las recomendaciones y acciones",placeholder:"recomendaciones y acciones",name:"recommendations_actions",modelValue:e(t).recommendations_actions,"onUpdate:modelValue":a[13]||(a[13]=o=>e(t).recommendations_actions=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"]),s(c,{label:"PERCEPCIONES/COMENTARIOS/AN\xC1LISIS FRENTE AL AVANCE DEL PROCESO *",tooltip:"Ingrese percepciones/comentarios/an\xE1lisis",placeholder:"Percepciones/comentarios/an\xE1lisis",name:"comments_analysis",modelValue:e(t).comments_analysis,"onUpdate:modelValue":a[14]||(a[14]=o=>e(t).comments_analysis=o),validator:e(l),rows:"5"},null,8,["modelValue","validator"])]),i("section",Ge,[s(P,{label:"DESARROLLO *",tooltip:"Arrastra o selecciona una Imagen",name:"file_1",ref:"file_1ref",to_edit:e(d).data.one.development_activity_image,modelValue:e(t).file_1,"onUpdate:modelValue":a[15]||(a[15]=o=>e(t).file_1=o),onAddfile:$,onRemovefile:B,files:e(p).I,validator:e(l)},null,8,["to_edit","modelValue","files","validator"]),s(P,{label:"EVIDENCIA DE PARTICIPACI\xD3N *",tooltip:"Arrastra o selecciona una Imagen",name:"file_2",ref:"file_2ref",to_edit:e(d).data.one.evidence_participation_image,modelValue:e(t).file_2,"onUpdate:modelValue":a[16]||(a[16]=o=>e(t).file_2=o),onAddfile:H,onRemovefile:k,files:e(p).II,validator:e(l)},null,8,["to_edit","modelValue","files","validator"])]),i("div",Je,[i("button",{disabled:e(_),type:"submit",class:"btn btn-primary w-24 ml-2"}," Ingresar ",8,qe)])],40,we)],8,he)])],64))}});export{_a as default};
