import{b as oe,s as X,m as se,d as K,v as $,f as _,g as A,t as M,k as G,h as m,F as W,x as ie,a5 as ne,a6 as re,l as e,M as de,i as s,O as S,r as F,E as q,c as ue,N as me,w as ce,j as pe,y as ve,ad as _e,B as fe,u as ge,q as be,Q as x}from"./index.c93647e1.js";import{u as he}from"./index.esm.8471a966.js";import{e as Ee}from"./es.d3f7231d.js";import{l as Ve}from"./localeData.68a39605.js";import{p as P}from"./permissions.c73d0fc1.js";import{r as n,a as E,b as V,n as Ce}from"./validations.9fff8c5b.js";import{u as Z}from"./methodologicalSheetsOne.service.ccdd648f.js";import{c as Ae}from"./cultural_ensembles.service.b546157f.js";import{c as ye}from"./generals.service.ee73141b.js";import{B as Oe,_ as j}from"./Input.d2784565.js";import{_ as C}from"./Textarea.8cc31183.js";import{_ as Se,a as k}from"./Management.8f9978fe.js";import{_ as p}from"./Select.7b4ad9bd.js";import{_ as xe}from"./FormHeader.f0e8692c.js";import{p as $e}from"./pecs.service.c1afe54a.js";import{s as Ie}from"./scroll.6a87917e.js";import{u as De}from"./useApi.3f746542.js";import"./index.esm.c98934a4.js";import"./useSlug.fdbf14df.js";import"./StateHeader.5dfd959d.js";import"./get_status.6c591513.js";import"./BaseBackButton.438a649f.js";import"./index.37cca9d1.js";const z=ye(),B=Ae(),Re=Z(),we=oe(),{options:v}=X(we),Q={status:"ENREV",consecutive:null,date:null,pec_id:null,datasheet_planning:null,filter_level:null,description:null,assembly_characteristics:null,objective_process:null,public_characteristics:null,cultural_right_id:null,lineament_id:null,orientation_id:null,value:null,artistic_expertise:null,evaluate_aspects:[],evaluate_aspects_comments:null,development_activity_image:null,evidence_participation_image:null,aforo_pdf:null,number_attendees:null,datasheet:null},Me=se("culturalEnsembles",{state:()=>({form:Object.assign({},Q),form_rules:{status:{required:n},date:{required:n},pec_id:{required:n},datasheet_planning:{required:n},filter_level:{required:n},description:{required:n,alpha:E,maxLength:V(3500)},assembly_characteristics:{required:n,alpha:E,maxLength:V(3500)},objective_process:{required:n,alpha:E,maxLength:V(3500)},public_characteristics:{required:n,alpha:E,maxLength:V(3500)},cultural_right_id:{required:n},lineament_id:{required:n},orientation_id:{required:n},value:{required:n},artistic_expertise:{required:n,alpha:E,maxLength:V(3500)},evaluate_aspects:{required:n},evaluate_aspects_comments:{required:n,alpha:E,maxLength:V(3500)},development_activity_image:{required:n},evidence_participation_image:{required:n},aforo_pdf:{required:n},number_attendees:{required:n,numeric:Ce},datasheet:{required:n}},form_options:{methodological_sheet:[],pecs:v.value.pecs,filter_level:v.value.filter_level,cultural_rights:v.value.cultural_rights,lineaments:v.value.lineaments,orientations:v.value.orientations,values:v.value.values,evaluate_aspects:v.value.evaluate_aspects},files:{development_activity_image:[],evidence_participation_image:[],aforo_pdf:[]},instance:{status:null,reject_message:null}}),actions:{async getCulturalConsecutive(){return await z.getConsecutive("cultural_ensembles","EC").then(()=>{this.form.consecutive=z.data.value})},async getCulturalEnsemble(i){const c=await B.getOne(i);await this.getInstance(c),this.form={...c}},async getInstance(i){const{status:c,reject_message:r}=i;this.instance.status=c,this.instance.reject_message=r},async addCulturalEnsemble(i){return B.create(i)},async editCulturalEnsemble(i,c){return B.update(i,c)},async getMethodologicalOptions(){await Re.get().then(i=>{this.form_options.methodological_sheet=i})},async clearForm(){Object.assign(this.form,Q)}},getters:{}}),Te={class:"BaseCheckGroup"},Ne={key:0,class:"form-label font-bold w-full text-left"},Le={class:"form-check my-3"},Ue={class:"mr-3",key:"index"},Fe=["name","id","value"],Pe=["for"],je=K({__name:"BaseCheckGroup",props:{name:null,label:null,options:null,tooltip:{type:[String,Boolean],default:!1},modelValue:{type:[String,Number,Boolean,Array]},validator:null},emits:["update:modelValue"],setup(i,{emit:c}){const r=i,y=$({get(){return r.modelValue},set(I){c("update:modelValue",I)}});return(I,D)=>(_(),A("div",Te,[i.label?(_(),A("label",Ne,M(i.label),1)):G("",!0),m("div",Le,[(_(!0),A(W,null,ie(i.options,(f,g)=>(_(),A("div",Ue,[ne(m("input",{type:"checkbox",class:"form-check-input w-5 h-5",name:i.name,id:i.name+g,value:f.value,"onUpdate:modelValue":D[0]||(D[0]=l=>de(y)?y.value=l:null)},null,8,Fe),[[re,e(y)]]),m("label",{class:"form-check-label",for:i.name+g},M(f.text||f.label),9,Pe)]))),128))]),s(Oe,{validator:i.validator,name:i.name,tooltip:i.tooltip},null,8,["validator","name","tooltip"])]))}}),ke={class:"intro-y box mt-5"},Be=["disabled"],Ge=["onSubmit"],He={class:"grid gap-5 grid-cols-2 md:grid-cols-2"},Je={class:"grid gap-5 grid-cols-1 md:grid-cols-2"},Ye={class:"grid gap-5 grid-cols-1 md:grid-cols-2"},qe={class:"grid gap-5 grid-cols-1"},ze={class:"grid gap-5 grid-cols-1 md:grid-cols-2"},Qe={class:"grid gap-5 grid-cols-1 md:grid-cols-2"},Xe={key:0,class:"flex justify-center"},Ke=["disabled"],Va=K({__name:"create",setup(i){const{find:c}=De();S.locale(Ee),S.extend(Ve);const r=Me(),y=Z(),{byActivityDate:I}=$e(),D=ge(),f=F([]),{is_role:g}=q.computed,{form:l,form_rules:ee,form_options:b,files:T,instance:H}=X(r),o=he(ee,l,{$autoDirty:!0,$lazy:!0}),O=be(),h=$(()=>!!O.params.id),R=F({development_activity_image:null,evidence_participation_image:null,aforo_pdf:null}),J=F([]),ae=async()=>{let{data:d}=await y.get();d.items.map(a=>{J.value.push({label:`${a.consecutive}${a.id} | ${a.date_ini} al ${a.date_fin}`,value:a.id})})};ue(async()=>{r.clearForm(),r.$reset(),await r.getMethodologicalOptions(),await ae(),await le(),h.value?(await r.getCulturalEnsemble(O.params.id),R.value={development_activity_image:l.value.development_activity_image,evidence_participation_image:l.value.evidence_participation_image,aforo_pdf:l.value.aforo_pdf}):r.getCulturalConsecutive()});const te=async()=>{if(await o.value.$validate()){const a={...l.value};h.value?await r.editCulturalEnsemble(O.params.id,a).then(t=>{x.general("\xA1Ficha editada exitosamente!"),D.push({name:"culturalEnsembles.index"})}).catch(t=>{x.error("Verifica todos los campos"+t)}):await r.getCulturalConsecutive().finally(()=>{r.addCulturalEnsemble(a).then(async t=>{x.general("\xA1Ficha creada exitosamente!"),r.$reset(),await r.clearForm(),o.value.$reset(),await r.getCulturalConsecutive(),Ie()}).catch(t=>{x.error("Verifica todos los campos")})})}else x.validation()},N=(d,a,t)=>{if(d)return;const{file:u}=a;l.value[t]=u},L=d=>{l.value[d]=null};function Y(d){const[a,t]=d.split(":"),u=a>=12?"PM":"AM";return`${a%12||12}:${t} ${u}`}const le=async()=>{const d=await I(),{items:a}=d.data;f.value=a.map(t=>({value:t.id,label:`${t.consecutive} - ${S(t.activity_date).format("DD/MM/YYYY")} - ${Y(t.start_time)} - ${Y(t.final_hour)}`}))};return(g("instructor")||g("super.root")||g("root"))&&me($(()=>l.value.date),async(d,a)=>{if(d!=null&&a!=null&&l.value.date){l.value.datasheet="Cargando...";const t=await c(`getDataSheet/cultural_ensembles/${l.value.date}/date`).then(U=>U.data),u=S(l.value.date).format("MMMM"),w=$(()=>`Ensamble ${t} - ${u}`);l.value.datasheet=w.value}if(!h.value){l.value.datasheet="Cargando...";const t=await c(`getDataSheet/cultural_ensembles/${l.value.date}/date`).then(U=>U.data),u=S(l.value.date).format("MMMM"),w=$(()=>`Ensamble ${t} - ${u}`);l.value.datasheet=w.value}}),(d,a)=>(_(),A(W,null,[s(xe,{state:{consecutive:e(l).consecutive,status:e(H).status,reject_message:e(H).reject_message}},{default:ce(()=>[pe(M(e(h)?`Edici\xF3n de Ensamble de Cultural #${e(O).params.id}`:"Ensamble de Cultural"),1)]),_:1},8,["state"]),e(h)&&e(P).culturalEnsembles.management()?(_(),ve(Se,{key:0,onSend:a[0]||(a[0]=t=>e(q).methods.send_management("cultural_ensembles",e(O).params.id,t)),class:"mt-5"})):G("",!0),m("div",ke,[m("fieldset",{disabled:e(P).culturalEnsembles.no_edit()},[m("form",{onSubmit:_e(te,["prevent"]),class:"grid gap-3 grid-cols-1 p-5 border-t border-slate-200/60"},[m("section",He,[s(j,{type:"date",label:"FECHA *",name:"date",placeholder:"Fecha",modelValue:e(l).date,"onUpdate:modelValue":a[1]||(a[1]=t=>e(l).date=t),validator:e(o)},null,8,["modelValue","validator"]),s(j,{name:"datasheet",type:"text",label:"FICHA NO. *",disabled:"",validator:e(o),modelValue:e(l).datasheet,"onUpdate:modelValue":a[2]||(a[2]=t=>e(l).datasheet=t)},null,8,["validator","modelValue"])]),m("section",Je,[s(p,{label:"PEC",validator:e(o),name:"pec_id",modelValue:e(l).pec_id,"onUpdate:modelValue":a[3]||(a[3]=t=>e(l).pec_id=t),options:e(f)},null,8,["validator","modelValue","options"]),s(p,{validator:e(o),name:"datasheet_planning",modelValue:e(l).datasheet_planning,"onUpdate:modelValue":a[4]||(a[4]=t=>e(l).datasheet_planning=t),options:e(J),"track-by":"id",label:"FICHAS METODOLOGICA PLANEACION *",placeholder:"Seleccione..."},null,8,["validator","modelValue","options"])]),m("section",Ye,[s(p,{validator:e(o),name:"filter_level",modelValue:e(l).filter_level,"onUpdate:modelValue":a[5]||(a[5]=t=>e(l).filter_level=t),options:e(b).filter_level,label:"NIVEL DE DOMINIO DEL SEMILLERO PARTICIPANTE"},null,8,["validator","modelValue","options"])]),m("section",qe,[s(C,{label:"DESCRIPCION *",placeholder:"Descripci\xF3n",name:"description",modelValue:e(l).description,"onUpdate:modelValue":a[6]||(a[6]=t=>e(l).description=t),validator:e(o),rows:"3"},null,8,["modelValue","validator"]),s(C,{label:"CARACTER\xCDSTICAS DEL ENSAMBLE *",placeholder:"Caracter\xEDsticas del ensamble",name:"assembly_characteristics",modelValue:e(l).assembly_characteristics,"onUpdate:modelValue":a[7]||(a[7]=t=>e(l).assembly_characteristics=t),validator:e(o),rows:"3"},null,8,["modelValue","validator"]),s(C,{label:"OBJETIVO DEL PROCESO *",placeholder:"Objetivo del proceso",name:"objective_process",modelValue:e(l).objective_process,"onUpdate:modelValue":a[8]||(a[8]=t=>e(l).objective_process=t),validator:e(o),rows:"3"},null,8,["modelValue","validator"]),s(C,{label:"CARACTERISTICAS P\xDABLICO ASISTENTE *",placeholder:"Caracteristicas del p\xFAblico asistente",name:"public_characteristics",modelValue:e(l).public_characteristics,"onUpdate:modelValue":a[9]||(a[9]=t=>e(l).public_characteristics=t),validator:e(o),rows:"3"},null,8,["modelValue","validator"])]),m("section",ze,[s(p,{validator:e(o),name:"cultural_right_id",modelValue:e(l).cultural_right_id,"onUpdate:modelValue":a[10]||(a[10]=t=>e(l).cultural_right_id=t),options:e(b).cultural_rights,label:"DERECHO CULTURAL"},null,8,["validator","modelValue","options"]),s(p,{validator:e(o),name:"lineament_id",modelValue:e(l).lineament_id,"onUpdate:modelValue":a[11]||(a[11]=t=>e(l).lineament_id=t),options:e(b).lineaments,label:"LINEAMIENTOS"},null,8,["validator","modelValue","options"]),s(p,{validator:e(o),name:"orientation_id",modelValue:e(l).orientation_id,"onUpdate:modelValue":a[12]||(a[12]=t=>e(l).orientation_id=t),options:e(b).orientations,label:"ORIENTACIONES"},null,8,["validator","modelValue","options"]),s(p,{validator:e(o),name:"value",modelValue:e(l).value,"onUpdate:modelValue":a[13]||(a[13]=t=>e(l).value=t),options:e(b).values,label:"VALOR"},null,8,["validator","modelValue","options"]),s(C,{class:"col-span-full",label:"EXPERTICIA ART\xCDSTICA A TRABAJAR *",placeholder:"Experticia art\xEDstica a trabajar",name:"artistic_expertise",modelValue:e(l).artistic_expertise,"onUpdate:modelValue":a[14]||(a[14]=t=>e(l).artistic_expertise=t),validator:e(o),rows:"3"},null,8,["modelValue","validator"])]),m("section",Qe,[s(je,{options:e(b).evaluate_aspects,name:"evaluate_aspects",validate:e(l).evaluate_aspects,label:"ASPECTOS A EVALUAR",validator:e(o),modelValue:e(l).evaluate_aspects,"onUpdate:modelValue":a[15]||(a[15]=t=>e(l).evaluate_aspects=t)},null,8,["options","validate","validator","modelValue"]),s(C,{class:"col-span-full",label:"COMENTARIOS *",placeholder:"Comentarios",name:"evaluate_aspects_comments",modelValue:e(l).evaluate_aspects_comments,"onUpdate:modelValue":a[16]||(a[16]=t=>e(l).evaluate_aspects_comments=t),"close-on-select":"false",validator:e(o),rows:"3"},null,8,["modelValue","validator"]),s(k,{label:"FOTO DEL DESARROLLO *",tooltip:"Arrastra una imagen JPG/PNG",name:"development_activity_image",ref:"development_activity_image",files:e(T).development_activity_image,validator:e(o),onAddfile:a[17]||(a[17]=(t,u)=>N(t,u,"development_activity_image")),onRemovefile:a[18]||(a[18]=t=>L("development_activity_image")),to_edit:e(R).development_activity_image},null,8,["files","validator","to_edit"]),s(k,{label:"EVIDENCIA DE PARTICIPACI\xD3N *",tooltip:"Arrastra una imagen JPG/PNG",name:"evidence_participation_image",ref:"evidence_participation_image",files:e(T).evidence_participation_image,validator:e(o),onAddfile:a[19]||(a[19]=(t,u)=>N(t,u,"evidence_participation_image")),onRemovefile:a[20]||(a[20]=t=>L("evidence_participation_image")),to_edit:e(R).evidence_participation_image},null,8,["files","validator","to_edit"]),s(k,{label:"DOCUMENTO DEL AFORO *",tooltip:"Arrastra un documento PDF",name:"aforo_pdf",ref:"aforo_pdf",files:e(T).aforo_pdf,validator:e(o),onAddfile:a[21]||(a[21]=(t,u)=>N(t,u,"aforo_pdf")),onRemovefile:a[22]||(a[22]=t=>L("aforo_pdf")),to_edit:e(R).aforo_pdf,accept_only_pdf:""},null,8,["files","validator","to_edit"]),s(j,{type:"text",label:"CAPACIDAD (NUMERO DE ASISTENTES) *",placeholder:"Ingrese cantidad",name:"number_attendees",modelValue:e(l).number_attendees,"onUpdate:modelValue":a[23]||(a[23]=t=>e(l).number_attendees=t),validator:e(o)},null,8,["modelValue","validator"])]),e(P).culturalEnsembles.no_edit()?G("",!0):(_(),A("div",Xe,[m("button",{type:"submit",class:"btn btn-primary w-24 mr-1 mb-2",disabled:e(fe)},M(e(h)?"Actualizar":"Ingresar"),9,Ke)]))],40,Ge)],8,Be)])],64))}});export{Va as default};
