import{m as X,d as Z,O as v,b as K,s as N,E as U,r as w,H as W,v as y,c as ee,ao as ae,N as te,f as O,g as le,i as o,w as ie,j as oe,t as M,l as e,y as F,k as P,h as s,ad as ne,n as se,F as re,u as de,q as ue,Q as me}from"./index.c93647e1.js";import{c as ce}from"./generals.service.ee73141b.js";import{_ as b}from"./Input.d2784565.js";import{_ as m}from"./Select.7b4ad9bd.js";import{_ as f}from"./Textarea.8cc31183.js";import{_ as pe,a as S}from"./Management.8f9978fe.js";import{u as _e}from"./cultural_circulations.service.1a70ea4e.js";import{p as B}from"./permissions.c73d0fc1.js";import{r as n,b as g}from"./validations.9fff8c5b.js";import{u as ve}from"./methodologicalSheetsOne.service.ccdd648f.js";import{u as fe}from"./index.esm.8471a966.js";import{e as ge}from"./es.d3f7231d.js";import{l as Ve}from"./localeData.68a39605.js";import{p as Ie}from"./pecs.service.c1afe54a.js";import{s as be}from"./scroll.6a87917e.js";import{_ as ye}from"./FormHeader.f0e8692c.js";import{u as Ce}from"./useApi.3f746542.js";import"./useSlug.fdbf14df.js";import"./index.esm.c98934a4.js";import"./index.37cca9d1.js";import"./StateHeader.5dfd959d.js";import"./get_status.6c591513.js";import"./BaseBackButton.438a649f.js";const Ae=X("cultural_circulations",{state:()=>({form:{date:"",status:"",consecutive:"",keyactors_circulation_alliance:"",pec_id:"",datasheet_planning_id:"",event_name:"",filter_level:"",description:"",nac_id:"",other_nac:"",quantity_members:"",public_characteristics:"",cultural_right_id:"",lineament_id:"",orientation_id:"",values:"",artistic_expertise:"",participation_observations:"",development_activity_image:null,evidence_participation_image:null,aforo_pdf:null,number_attendees:"",datasheet:null},form_rules:{date:{required:n},keyactors_circulation_alliance:{required:n,maxLength:g(3500)},pec_id:{required:n},datasheet_planning_id:{required:n},event_name:{required:n,maxLength:g(3500)},filter_level:{required:n},description:{required:n,maxLength:g(3500)},nac_id:{required:n},quantity_members:{required:n},public_characteristics:{required:n,maxLength:g(3500)},cultural_right_id:{required:n},lineament_id:{required:n},orientation_id:{required:n},values:{required:n},artistic_expertise:{required:n,maxLength:g(3500)},participation_observations:{required:n,maxLength:g(3500)},development_activity_image:{required:n},evidence_participation_image:{required:n},aforo_pdf:{required:n},number_attendees:{required:n},other_nac:{},datasheet:{required:n}},filesOne:{development_activity_image:null,evidence_participation_image:null,aforo_pdf:null}}),getters:{getterForm:V=>V.form,getFulesComputed:V=>({...V.form_rules,other_nac:V.form.nac_id=="67"?{required:n}:{}})},actions:{}}),Ee={class:"p-5 mt-5 intro-y box"},xe=["disabled"],De=["onSubmit"],he={class:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2"},Oe={class:"col-span-1 sm:col-span-2"},Se={class:"col-span-1 sm:col-span-2"},Re={class:"col-span-1 sm:col-span-2"},Te={class:"pt-8"},$e=s("h3",{class:"text-lg font-medium leading-6 text-gray-900"}," Componente Metodol\xF3gico ",-1),Le={class:"mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2"},Ne={class:"pt-8"},Ue=s("h3",{class:"text-lg font-medium leading-6 text-gray-900"},"Otros",-1),we={class:"mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2"},Me={class:"pt-5"},Fe={class:"flex justify-end gap-x-4"},Pe={type:"submit",class:"btn btn-primary"},da=Z({__name:"culturalCirculationNew",setup(V){v.locale(ge),v.extend(Ve);const{find:R}=Ce(),{byActivityDate:k}=Ie(),C=_e(),q=ce(),j=K(),A=Ae(),{form:a,getFulesComputed:H,filesOne:c}=N(A),i=fe(H,a,{$autoDirty:!0,$lazy:!0}),{options:p}=N(j),Y=ve(),z=de(),{is_role:E}=U.computed,T=w([]),I=ue(),u=W({I:[],II:[],III:[]}),$=w(""),_=y(()=>!!I.params.id),x=async()=>{let{data:r}=await q.getConsecutive("cultural_circulations","BCC");a.value.consecutive=r},G=async()=>{let{data:r}=await Y.get();r.items.map(t=>{T.value.push({label:`${t.consecutive}${t.id} | ${t.date_ini} al ${t.date_fin}`,value:t.id})})},J=async()=>{try{await i.value.$validate()?_.value?(await C.update(I.params.id,a.value)).data.success&&z.push({name:"culturalCirculations.index"}):await x().finally(()=>{C.create(a.value).then(async t=>{t.data.success&&(A.$reset(),i.value.$reset(),be(),await x(),u.I=[],u.II=[],u.III=[])})}):me.validation()}catch{}};ee(async()=>{var r;if(A.$reset(),i.value.$reset(),u.I=[],u.II=[],u.III=[],await G(),_.value){const{data:{items:t}}=await C.getOne((r=I.params)==null?void 0:r.id);$.value=t.reject_message;const{...l}=t;a.value=l,c.value.aforo_pdf=t.aforo_pdf,c.value.development_activity_image=t.development_activity_image,c.value.evidence_participation_image=t.evidence_participation_image}else x()});function L(r){return v(`1999-01-01 ${r}`).format("hh:mm A")}const Q=ae(async()=>{const r=await k(),{items:t}=r.data;return t.map(l=>({value:l.id,label:`${l.consecutive} - ${v(l.activity_date).format("DD/MM/YYYY")} - ${L(l.start_time)} - ${L(l.final_hour)}`}))},null);return(E("instructor")||E("super.root")||E("root"))&&te(y(()=>a.value.date),async(r,t)=>{if(r!=null&&t!=""&&a.value.date){a.value.datasheet="Cargando...";const l=await R(`getDataSheet/cultural_circulations/${a.value.date}/date`).then(h=>h.data),d=v(a.value.date).format("MMMM"),D=y(()=>`Circulaci\xF3n ${l} - ${d}`);a.value.datasheet=D.value}if(!_.value){a.value.datasheet="Cargando...";const l=await R(`getDataSheet/cultural_circulations/${a.value.date}/date`).then(h=>h.data),d=v(a.value.date).format("MMMM"),D=y(()=>`Circulaci\xF3n ${l} - ${d}`);a.value.datasheet=D.value}}),(r,t)=>(O(),le(re,null,[o(ye,{state:{consecutive:e(a).consecutive,status:e(a).status,reject_message:$.value}},{default:ie(()=>{var l;return[oe(M(e(_)?`Bit\xE1cora circulaci\xF3n cultural #${(l=e(I))==null?void 0:l.params.id}`:"Bit\xE1cora circulaci\xF3n cultural"),1)]}),_:1},8,["state"]),e(_)&&e(B).cultural_circulation.management()?(O(),F(pe,{key:0,class:"mt-5",onSend:t[0]||(t[0]=l=>{var d;return e(U).methods.send_management("cultural_circulations",(d=e(I))==null?void 0:d.params.id,l)})})):P("",!0),s("div",Ee,[s("fieldset",{disabled:e(B).cultural_circulation.no_edit()},[s("form",{onSubmit:ne(J,["prevent"]),class:"space-y-8 divide-y divide-slate-200"},[s("div",null,[s("div",he,[o(b,{type:"date",label:"FECHA *",name:"date",modelValue:e(a).date,"onUpdate:modelValue":t[1]||(t[1]=l=>e(a).date=l),validator:e(i)},null,8,["modelValue","validator"]),o(b,{name:"datasheet",type:"text",label:"FICHA NO. *",disabled:"",validator:e(i),modelValue:e(a).datasheet,"onUpdate:modelValue":t[2]||(t[2]=l=>e(a).datasheet=l)},null,8,["validator","modelValue"]),o(b,{type:"number",label:"CANTIDAD DE INTEGRANTES DE SEMILLERO *",placeholder:"0, 10, 20...",name:"quantity_members",modelValue:e(a).quantity_members,"onUpdate:modelValue":t[3]||(t[3]=l=>e(a).quantity_members=l),validator:e(i)},null,8,["modelValue","validator"]),s("div",Oe,[o(f,{label:"ACTORES CLAVES DE ALIANZA PARA LA CIRCULACI\xD3N *",name:"keyactors_circulation_alliance",modelValue:e(a).keyactors_circulation_alliance,"onUpdate:modelValue":t[4]||(t[4]=l=>e(a).keyactors_circulation_alliance=l),validator:e(i),rows:"3"},null,8,["modelValue","validator"])]),o(m,{label:"FILTRO PEC *",placeholder:"PEC Relacionado",name:"pec_id",modelValue:e(a).pec_id,"onUpdate:modelValue":t[5]||(t[5]=l=>e(a).pec_id=l),value:e(a).pec_id,options:e(Q)||null,validator:e(i)},null,8,["modelValue","value","options","validator"]),o(m,{label:"FICHA METODOL\xD3GICA PLANEACI\xD3N *",placeholder:"Ficha relacionada",name:"datasheet_planning_id",modelValue:e(a).datasheet_planning_id,"onUpdate:modelValue":t[6]||(t[6]=l=>e(a).datasheet_planning_id=l),value:e(a).datasheet_planning_id,options:T.value||null,validator:e(i)},null,8,["modelValue","value","options","validator"]),s("div",Se,[o(f,{label:"NOMBRE DEL EVENTO *",name:"event_name",modelValue:e(a).event_name,"onUpdate:modelValue":t[7]||(t[7]=l=>e(a).event_name=l),validator:e(i),rows:"3"},null,8,["modelValue","validator"])]),s("div",Re,[o(m,{label:"NIVEL DE DOMINIO DEL SEMILLERO PARTICIPANTE *",placeholder:"Dominio",name:"filter_level",modelValue:e(a).filter_level,"onUpdate:modelValue":t[8]||(t[8]=l=>e(a).filter_level=l),value:e(a).filter_level,options:e(p).filter_level||[],validator:e(i)},null,8,["modelValue","value","options","validator"])]),s("div",{class:se([{"grid grid-cols-2 gap-x-4":e(a).nac_id=="67"},"col-span-1 sm:col-span-2"])},[o(m,{label:"TERRITORIO DE CIRCULACI\xD3N *",placeholder:"Territorio",name:"nac_id",modelValue:e(a).nac_id,"onUpdate:modelValue":t[9]||(t[9]=l=>e(a).nac_id=l),value:e(a).nac_id,options:e(p).nacs_with_other||null,validator:e(i)},null,8,["modelValue","value","options","validator"]),e(a).nac_id=="67"?(O(),F(b,{key:0,class:"intro-y",type:"text",label:"\xBFOTRO CUAL?",placeholder:"Otro territorio",name:"other_nac",modelValue:e(a).other_nac,"onUpdate:modelValue":t[10]||(t[10]=l=>e(a).other_nac=l),validator:e(i)},null,8,["modelValue","validator"])):P("",!0)],2),o(f,{label:"DESCRIPCI\xD3N",name:"description",modelValue:e(a).description,"onUpdate:modelValue":t[11]||(t[11]=l=>e(a).description=l),validator:e(i),rows:"3"},null,8,["modelValue","validator"]),o(f,{label:"CARACTER\xCDSTICAS DEL P\xDABLICO ASISTENTE",name:"public_characteristics",modelValue:e(a).public_characteristics,"onUpdate:modelValue":t[12]||(t[12]=l=>e(a).public_characteristics=l),validator:e(i),rows:"3"},null,8,["modelValue","validator"])])]),s("div",Te,[$e,s("div",Le,[o(m,{label:"DERECHO CULTURAL *",placeholder:"Seleccione",name:"cultural_right_id",modelValue:e(a).cultural_right_id,"onUpdate:modelValue":t[13]||(t[13]=l=>e(a).cultural_right_id=l),value:e(a).cultural_right_id,options:e(p).cultural_rights||null,validator:e(i)},null,8,["modelValue","value","options","validator"]),o(m,{label:"LINEAMIENTOS *",placeholder:"Seleccione",name:"lineament_id",modelValue:e(a).lineament_id,"onUpdate:modelValue":t[14]||(t[14]=l=>e(a).lineament_id=l),value:e(a).lineament_id,options:e(p).lineaments||null,validator:e(i)},null,8,["modelValue","value","options","validator"]),o(m,{label:"ORIENTACIONES *",placeholder:"Seleccione",name:"orientation_id",modelValue:e(a).orientation_id,"onUpdate:modelValue":t[15]||(t[15]=l=>e(a).orientation_id=l),value:e(a).orientation_id,options:e(p).orientations||null,validator:e(i)},null,8,["modelValue","value","options","validator"]),o(m,{label:"VALOR *",placeholder:"Seleccione",name:"values",modelValue:e(a).values,"onUpdate:modelValue":t[16]||(t[16]=l=>e(a).values=l),value:e(a).values,options:e(p).values||null,validator:e(i)},null,8,["modelValue","value","options","validator"]),o(f,{label:"EXPERTICIA ART\xCDSTICA A TRABAJAR",name:"artistic_expertise",modelValue:e(a).artistic_expertise,"onUpdate:modelValue":t[17]||(t[17]=l=>e(a).artistic_expertise=l),validator:e(i),rows:"3"},null,8,["modelValue","validator"]),o(f,{label:"OBSERVACIONES DE TU PARTICIPACI\xD3N",name:"participation_observations",modelValue:e(a).participation_observations,"onUpdate:modelValue":t[18]||(t[18]=l=>e(a).participation_observations=l),validator:e(i),rows:"3"},null,8,["modelValue","validator"])])]),s("div",Ne,[Ue,s("div",we,[o(S,{label:"FOTO DEL DESARROLLO *",name:"development_activity_image",ref:"development_activity_image",modelValue:e(a).development_activity_image,"onUpdate:modelValue":t[19]||(t[19]=l=>e(a).development_activity_image=l),onAddfile:t[20]||(t[20]=(l,d)=>e(a).development_activity_image=d.file),onRemovefile:t[21]||(t[21]=l=>e(a).development_activity_image=null),validator:e(i),to_edit:e(c).development_activity_image,files:e(u).I},null,8,["modelValue","validator","to_edit","files"]),o(S,{label:"EVIDENCIA DE PARTICIPACI\xD3N *",name:"evidence_participation_image",ref:"evidence_participation_image",modelValue:e(a).evidence_participation_image,"onUpdate:modelValue":t[22]||(t[22]=l=>e(a).evidence_participation_image=l),onAddfile:t[23]||(t[23]=(l,d)=>e(a).evidence_participation_image=d.file),onRemovefile:t[24]||(t[24]=l=>e(a).evidence_participation_image=null),validator:e(i),to_edit:e(c).evidence_participation_image,files:e(u).II},null,8,["modelValue","validator","to_edit","files"]),o(S,{label:"DOCUMENTO DEL AFORO *",accept_only_pdf:!0,name:"aforo_pdf",ref:"aforo_pdf",modelValue:e(a).aforo_pdf,"onUpdate:modelValue":t[25]||(t[25]=l=>e(a).aforo_pdf=l),onAddfile:t[26]||(t[26]=(l,d)=>e(a).aforo_pdf=d.file),onRemovefile:t[27]||(t[27]=l=>e(a).aforo_pdf=null),validator:e(i),to_edit:e(c).aforo_pdf,files:e(u).III},null,8,["modelValue","validator","to_edit","files"]),o(b,{type:"number",label:"CAPACIDAD (NUMERO DE ASISTENTES) *",placeholder:"0, 10, 20...",name:"number_attendees",modelValue:e(a).number_attendees,"onUpdate:modelValue":t[28]||(t[28]=l=>e(a).number_attendees=l),validator:e(i)},null,8,["modelValue","validator"])])]),s("div",Me,[s("div",Fe,[s("button",Pe,M(e(_)?"Actualizar":"Guardar"),1)])])],40,De)],8,xe)])],64))}});export{da as default};
