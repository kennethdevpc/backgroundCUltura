import{H as $,r as g,u as R,P as o,K as c,Q as l,d as w,v as N,D as O,f as A,g as I,h as f,i as C,l as _,M as D,F as b,q as F,e as L}from"./index.c93647e1.js";import{_ as S}from"./BaseCrud.3eb21af2.js";import"./DatasheetFormat.bb093e19.js";import"./description.c57d405a.js";import"./user.service.5d6ec521.js";import"./useSlug.fdbf14df.js";import"./Input.d2784565.js";import"./Select.7b4ad9bd.js";import"./get_status.6c591513.js";const u="activityLogs",d="api/v1";function V(){const r=$({all:[],one:{},no_paginate:[],user_id:null,count_page:0}),p=R(),n=g("");return{data:r,errors:n,get:async a=>{var t;try{o(!0);let e=await c.get(`/${d}/${u}?page=`+a).finally(()=>{o(!1)});e.status===200&&(r.all=e.data.items,r.count_page=e.data.count_page)}catch(e){l.custom_validation((t=e.response.data.error)!=null?t:e.response.data.message)}},getOne:async a=>{var t;try{o(!0);let e=await c.get(`/${d}/${u}/${a}`).finally(()=>{o(!1)});e.status===200&&(r.one=e.data.items)}catch(e){l.custom_validation((t=e.response.data.error)!=null?t:e.response.data.message)}},update:async(a,t)=>{var e;n.value="";try{o(!0),(await c.put(`/${d}/${u}/${a}`,t).finally(()=>{o(!1)})).status==200&&p.push({name:"activityLogs.index",params:{}})}catch(s){l.custom_validation((e=s.response.data.error)!=null?e:s.response.data.message)}},create:async a=>{var t;n.value="";try{o(!0);const e=await c.post(`/${d}/${u}`,a).finally(()=>{o(!1)});return e.status===200&&(r.user_id=e.data.items.id),e}catch(e){l.error((t=e.response.data.error)!=null?t:e.response.data.message)}},destroy:async a=>{var t;try{o(!0),(await c.delete(`/${d}/${u}/${a}`).finally(()=>{o(!1)})).status===200&&await p.push({name:"activityLogs.index"})}catch(e){l.custom_validation((t=e.response.data.error)!=null?t:e.response.data.message)}}}}const j=f("div",{class:"intro-y flex flex-col sm:flex-row items-center mt-8"},[f("h2",{class:"text-lg font-medium mr-auto"},"Actividad de la plataforma")],-1),B={class:"intro-y box p-5 mt-5"},M={class:"flex items-center justify-center p-2 text-base"},Q=w({__name:"index",setup(r){R();const p=F(),n=V();N(()=>String(p.name).split(".")[0]);async function v(e){await n.destroy(e),t()}const y=[{text:"#",value:"id"},{text:"NAME",value:"log_name"},{text:"DESCRIPCION",value:"description"},{text:"LUGAR",value:"subject_type"},{text:"EVENTO",value:"event"},{text:"FECHA REGISTRO",value:"created_at"},{text:"ACCIONES",value:"actions"}],m=g([]),x=e=>{const{id:s}=e;return{id:s,sections:{general:{title:"Datos Generales",fields:{NOMBRE:e.log_name,DESCRIPCION:e.description,LUGAR:e.subject_type,EVENTO:e.event,"FECHA REGISTRO":e.created_at}},relation:{title:"Relaci\xF3n",fields:{ID:e.subject.id,NOMBRE:e.subject.name,"FECHA CREACI\xD3N":e.subject.created_at}}}}};let i=g(1),a=g(0);async function t(){await n.get(i.value),m.value=n.data.all,a.value=n.data.count_page}return O(async()=>{await t(),m.value.map(e=>({...e,actions:"Acciones"}))}),(e,s)=>{const h=L("v-pagination");return A(),I(b,null,[j,f("div",B,[f("div",M,[C(h,{modelValue:_(i),"onUpdate:modelValue":[s[0]||(s[0]=E=>D(i)?i.value=E:i=E),t],pages:_(a),"range-size":1,"active-color":"#DCEDFF"},null,8,["modelValue","pages"])]),C(S,{onChange_status:s[1]||(s[1]=async()=>await t()),headers:y,items:_(m),item_see_fnc:x,label:"Usuarios","on-delete-fnc":v,hiddenButton:!0,server_options:{page:1,rowsPerPage:15}},null,8,["items"])])],64)}}});export{Q as default};
