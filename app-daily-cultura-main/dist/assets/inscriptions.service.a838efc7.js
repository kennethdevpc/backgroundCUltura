import{H as z,r as w,u as x,P as i,K as h,Q as r,E as C}from"./index.c93647e1.js";const u="inscriptions",y="api/v1";function B(){const g=z({all:[],one:{},count_page:0}),N=x(),m=w("");return{data:g,errors:m,get:async(n,t=null)=>{var a;try{i(!0);let s=Boolean(t)?`?page=${n}&${t}`:`?page=${n}`,e=await h.get(`/${y}/${u}${s}`).finally(()=>{i(!1)});e.status===200&&(g.all=e.data.items,g.count_page=e.data.count_page)}catch(s){r.custom_validation((a=s.response.data.error)!=null?a:s.response.data.message)}},getOne:async n=>{var t;try{i(!0);let a=await h.get(`/${y}/${u}/${n}`).finally(()=>{i(!1)});return a.status===200&&(g.one=a.data.items),a}catch(a){a.response.status===404?C.not_found_by_id():r.custom_validation((t=a.response.data.error)!=null?t:a.response.data.message)}},update:async(n,t)=>{var J;m.value="";const a=new FormData,{identifiers:s,beneficiary:e,attendant:c}=t,{general_data:o,health_data:d,sociodemographic_characterization:f}=e,{file:p,consecutive:_,...v}=o;a.append("consecutive",_),a.append("beneficiary",JSON.stringify(v)),a.append("beneficiary_health_data",JSON.stringify(d)),a.append("beneficiary_sociodemographic_characterization",JSON.stringify(f)),a.append("beneficiary_file",p!=null?p.file:null);const{general_data:O,health_data:b,sociodemographic_characterization:S}=c,{...$}=O;a.append("attendant",JSON.stringify($)),a.append("attendant_health_data",JSON.stringify(b)),a.append("attendant_sociodemographic_characterization",JSON.stringify(S)),a.append("identifiers",JSON.stringify(s));try{i(!0);const l=await h.post(`/${y}/${u}/${n}`,a,{"Content-Type":"multipart/formdata"}).finally(()=>{i(!1)});return l.status==200&&(r.update(),N.push({name:"inscriptions.index"})),l}catch(l){r.custom_validation((J=l.response.data.error)!=null?J:l.response.data.message),m.value=l.response.data.errors}},create:async(n,t)=>{var s;m.value="";const a=new FormData;if(t==="uncharacterized"){const{beneficiary:e}=n,{general_data:c}=e,{consecutive:o,...d}=c;a.append("consecutive",o),a.append("beneficiary",JSON.stringify(d))}if(t==="characterized"){const{beneficiary:e}=n,{general_data:c,health_data:o,sociodemographic_characterization:d}=e,{file:f,consecutive:p,..._}=c;a.append("consecutive",p),a.append("beneficiary",JSON.stringify(_)),a.append("beneficiary_health_data",JSON.stringify(o)),a.append("beneficiary_sociodemographic_characterization",JSON.stringify(d)),a.append("beneficiary_file",f.file)}if(t==="characterizedWithAccudent"){const{beneficiary:e,attendant:c}=n,{general_data:o,health_data:d,sociodemographic_characterization:f}=e,{file:p,consecutive:_,...v}=o;a.append("consecutive",_),a.append("beneficiary",JSON.stringify(v)),a.append("beneficiary_health_data",JSON.stringify(d)),a.append("beneficiary_sociodemographic_characterization",JSON.stringify(f)),a.append("beneficiary_file",p.file);const{general_data:O,health_data:b,sociodemographic_characterization:S}=c,{...$}=O;a.append("attendant",JSON.stringify($)),a.append("attendant_health_data",JSON.stringify(b)),a.append("attendant_sociodemographic_characterization",JSON.stringify(S))}try{i(!0);const e=await h.post(`/${y}/${u}?type=${t}`,a,{"Content-Type":"multipart/form-data"}).finally(()=>{i(!1)});return e.status==200&&e.data.success&&r.create(),e}catch(e){r.custom_validation((s=e.response.data.error)!=null?s:e.response.data.message)}},destroy:async n=>{var t;try{i(!0),(await h.delete(`/${y}/${u}/${n}`).finally(()=>{i(!1)})).status==200&&r.destroy("Inscripci\xF3n",n)}catch(a){r.custom_validation((t=a.response.data.error)!=null?t:a.response.data.message)}}}}export{B as i};
